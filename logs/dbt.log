[0m20:58:58.636789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D76BA33250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D76DAA95B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D76DAA9400>]}


============================== 20:58:58.636789 | 33908dcd-8509-41e6-a34f-b71501e8a333 ==============================
[0m20:58:58.636789 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:58:58.636789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\amiru\\Documents\\mochi_dbt\\mochi_analysis\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\amiru\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:58:58.636789 [info ] [MainThread]: dbt version: 1.9.4
[0m20:58:58.652917 [info ] [MainThread]: python version: 3.9.7
[0m20:58:58.652917 [info ] [MainThread]: python path: C:\Users\amiru\AppData\Local\Programs\Python\Python39\python.exe
[0m20:58:58.653552 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m20:58:58.694773 [info ] [MainThread]: Using profiles dir at C:\Users\amiru\.dbt
[0m20:58:58.695774 [info ] [MainThread]: Using profiles.yml file at C:\Users\amiru\.dbt\profiles.yml
[0m20:58:58.696786 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\dbt_project.yml
[0m20:58:58.696786 [info ] [MainThread]: adapter type: postgres
[0m20:58:58.696786 [info ] [MainThread]: adapter version: 1.9.0
[0m20:58:58.757212 [info ] [MainThread]: Configuration:
[0m20:58:58.757212 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:58:58.757212 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:58:58.757212 [info ] [MainThread]: Required dependencies:
[0m20:58:58.757212 [debug] [MainThread]: Executing "git --help"
[0m20:58:58.794547 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:58:58.795558 [debug] [MainThread]: STDERR: "b''"
[0m20:58:58.795558 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:58:58.795558 [info ] [MainThread]: Connection:
[0m20:58:58.796641 [info ] [MainThread]:   host: localhost
[0m20:58:58.796641 [info ] [MainThread]:   port: 5432
[0m20:58:58.796641 [info ] [MainThread]:   user: postgres
[0m20:58:58.797640 [info ] [MainThread]:   database: mochi_data
[0m20:58:58.797640 [info ] [MainThread]:   schema: dbt_mochi
[0m20:58:58.797640 [info ] [MainThread]:   connect_timeout: 10
[0m20:58:58.798640 [info ] [MainThread]:   role: None
[0m20:58:58.798640 [info ] [MainThread]:   search_path: None
[0m20:58:58.798640 [info ] [MainThread]:   keepalives_idle: 0
[0m20:58:58.799640 [info ] [MainThread]:   sslmode: None
[0m20:58:58.799640 [info ] [MainThread]:   sslcert: None
[0m20:58:58.799640 [info ] [MainThread]:   sslkey: None
[0m20:58:58.800640 [info ] [MainThread]:   sslrootcert: None
[0m20:58:58.800640 [info ] [MainThread]:   application_name: dbt
[0m20:58:58.801419 [info ] [MainThread]:   retries: 1
[0m20:58:58.801419 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:58:59.052145 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:58:59.116956 [debug] [MainThread]: Using postgres connection "debug"
[0m20:58:59.116956 [debug] [MainThread]: On debug: select 1 as id
[0m20:58:59.117957 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:58:59.118317 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m20:58:59.118317 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m20:58:59.118317 [debug] [MainThread]: On debug: No close available on handle
[0m20:58:59.118317 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:58:59.119316 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:58:59.119316 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  embedded null character

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:58:59.121300 [debug] [MainThread]: Command `dbt debug` failed at 20:58:59.120302 after 0.55 seconds
[0m20:58:59.121300 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:58:59.121300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D76BA33250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D76DA6E760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D76DC2FBE0>]}
[0m20:58:59.121300 [debug] [MainThread]: Flushing usage events
[0m20:59:00.084151 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:01:19.528897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229A66D3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229A777E5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229A777E400>]}


============================== 21:01:19.528897 | 86942334-d80a-4e19-b700-0d5997ca1bbe ==============================
[0m21:01:19.528897 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:01:19.544523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\amiru\\Documents\\mochi_dbt\\mochi_analysis\\logs', 'profiles_dir': 'C:\\Users\\amiru\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:01:19.544523 [info ] [MainThread]: dbt version: 1.9.4
[0m21:01:19.544523 [info ] [MainThread]: python version: 3.9.7
[0m21:01:19.556599 [info ] [MainThread]: python path: C:\Users\amiru\AppData\Local\Programs\Python\Python39\python.exe
[0m21:01:19.557248 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m21:01:19.590273 [info ] [MainThread]: Using profiles dir at C:\Users\amiru\.dbt
[0m21:01:19.590273 [info ] [MainThread]: Using profiles.yml file at C:\Users\amiru\.dbt\profiles.yml
[0m21:01:19.590273 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\dbt_project.yml
[0m21:01:19.600769 [info ] [MainThread]: adapter type: postgres
[0m21:01:19.600769 [info ] [MainThread]: adapter version: 1.9.0
[0m21:01:19.667944 [info ] [MainThread]: Configuration:
[0m21:01:19.674447 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:01:19.674447 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:01:19.674447 [info ] [MainThread]: Required dependencies:
[0m21:01:19.674447 [debug] [MainThread]: Executing "git --help"
[0m21:01:19.690559 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:01:19.690559 [debug] [MainThread]: STDERR: "b''"
[0m21:01:19.690559 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:01:19.690559 [info ] [MainThread]: Connection:
[0m21:01:19.699617 [info ] [MainThread]:   host: localhost
[0m21:01:19.699617 [info ] [MainThread]:   port: 5432
[0m21:01:19.699617 [info ] [MainThread]:   user: postgres
[0m21:01:19.700616 [info ] [MainThread]:   database: mochi_data
[0m21:01:19.700616 [info ] [MainThread]:   schema: dbt_mochi
[0m21:01:19.701616 [info ] [MainThread]:   connect_timeout: 10
[0m21:01:19.701917 [info ] [MainThread]:   role: None
[0m21:01:19.701917 [info ] [MainThread]:   search_path: None
[0m21:01:19.701917 [info ] [MainThread]:   keepalives_idle: 0
[0m21:01:19.702915 [info ] [MainThread]:   sslmode: None
[0m21:01:19.702915 [info ] [MainThread]:   sslcert: None
[0m21:01:19.702915 [info ] [MainThread]:   sslkey: None
[0m21:01:19.702915 [info ] [MainThread]:   sslrootcert: None
[0m21:01:19.704192 [info ] [MainThread]:   application_name: dbt
[0m21:01:19.704192 [info ] [MainThread]:   retries: 1
[0m21:01:19.704192 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:01:19.977880 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:01:20.050895 [debug] [MainThread]: Using postgres connection "debug"
[0m21:01:20.050895 [debug] [MainThread]: On debug: select 1 as id
[0m21:01:20.050895 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:01:20.086274 [debug] [MainThread]: SQL status: SELECT 1 in 0.035 seconds
[0m21:01:20.087274 [debug] [MainThread]: On debug: Close
[0m21:01:20.087274 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:01:20.088274 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:01:20.089275 [debug] [MainThread]: Command `dbt debug` succeeded at 21:01:20.089275 after 0.61 seconds
[0m21:01:20.089275 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:01:20.089275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229A66D3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229A6A1D700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229A773D760>]}
[0m21:01:20.090275 [debug] [MainThread]: Flushing usage events
[0m21:01:21.405398 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:03:18.962577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225D7993280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225D9A095B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225D9A09400>]}


============================== 21:03:18.978194 | a416b0bc-3441-497c-b2e3-7be804efc239 ==============================
[0m21:03:18.978194 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:03:18.978194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\amiru\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\amiru\\Documents\\mochi_dbt\\mochi_analysis\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt parse', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:03:19.160770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a416b0bc-3441-497c-b2e3-7be804efc239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225D99E3C40>]}
[0m21:03:19.207658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a416b0bc-3441-497c-b2e3-7be804efc239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225D99D8C10>]}
[0m21:03:19.207658 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:03:19.462593 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:03:19.462593 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:03:19.462593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a416b0bc-3441-497c-b2e3-7be804efc239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225D9B72640>]}
[0m21:03:20.403234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a416b0bc-3441-497c-b2e3-7be804efc239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225DB1DEDC0>]}
[0m21:03:20.403234 [info ] [MainThread]: Performance info: C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\perf_info.json
[0m21:03:20.479411 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\manifest.json
[0m21:03:20.479411 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\semantic_manifest.json
[0m21:03:20.479411 [debug] [MainThread]: Command `dbt parse` succeeded at 21:03:20.479411 after 1.56 seconds
[0m21:03:20.479411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225D7993280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225D99D8C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225DB24A790>]}
[0m21:03:20.479411 [debug] [MainThread]: Flushing usage events
[0m21:03:21.782321 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:10:33.044514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AFFD532E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A81F37940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A81F37AF0>]}


============================== 21:10:33.047662 | f12f7f7c-026b-48d1-aa84-8f5b2d97e658 ==============================
[0m21:10:33.047662 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:10:33.047662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\amiru\\Documents\\mochi_dbt\\mochi_analysis\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\amiru\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:10:33.229849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f12f7f7c-026b-48d1-aa84-8f5b2d97e658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A81F28850>]}
[0m21:10:33.272338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f12f7f7c-026b-48d1-aa84-8f5b2d97e658', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A8115ECD0>]}
[0m21:10:33.273339 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:10:33.531787 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:10:33.694467 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:10:33.694467 [debug] [MainThread]: Partial parsing: added file: mochi_analysis://models\Staging\stg_panel_evaluations.sql
[0m21:10:33.827798 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.mochi_analysis.stg_panel_evaluations' (models\Staging\stg_panel_evaluations.sql) depends on a source named 'public.raw_panel_evaluations' which was not found
[0m21:10:33.827798 [debug] [MainThread]: Command `dbt run` failed at 21:10:33.827798 after 0.85 seconds
[0m21:10:33.827798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AFFD532E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A825F0C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A82017460>]}
[0m21:10:33.827798 [debug] [MainThread]: Flushing usage events
[0m21:10:34.825683 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:12:21.881959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015932403280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159334B6700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000159334B6550>]}


============================== 21:12:21.884959 | a6040f1b-f1cc-4930-99e2-510c9119d34f ==============================
[0m21:12:21.884959 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:12:21.884959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\amiru\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\amiru\\Documents\\mochi_dbt\\mochi_analysis\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:12:22.019137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6040f1b-f1cc-4930-99e2-510c9119d34f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001593348D0D0>]}
[0m21:12:22.073294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6040f1b-f1cc-4930-99e2-510c9119d34f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001593347B5B0>]}
[0m21:12:22.073294 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:12:22.333713 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:12:22.474347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m21:12:22.474347 [debug] [MainThread]: Partial parsing: added file: mochi_analysis://models\Staging\stg_panel_evaluations.sql
[0m21:12:22.474347 [debug] [MainThread]: Partial parsing: added file: mochi_analysis://models\sources.yml
[0m21:12:22.619998 [error] [MainThread]: Encountered an error:
Parsing Error
  Failed to render models\sources.yml from project mochi_analysis: Parsing Error
    Env var required but not provided: 'DBT_POSTGRES_DATABASE'
[0m21:12:22.620999 [debug] [MainThread]: Command `dbt run` failed at 21:12:22.620999 after 0.81 seconds
[0m21:12:22.620999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015932403280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015933C11A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015933C11D90>]}
[0m21:12:22.620999 [debug] [MainThread]: Flushing usage events
[0m21:12:23.644537 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:13:28.618804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC8D33250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC9DE55E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC9DE5430>]}


============================== 21:13:28.618804 | 5426254e-c3cb-48c0-803e-2edcd14d8214 ==============================
[0m21:13:28.618804 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:13:28.618804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\amiru\\Documents\\mochi_dbt\\mochi_analysis\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\amiru\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:13:28.771277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5426254e-c3cb-48c0-803e-2edcd14d8214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC9EDFA60>]}
[0m21:13:28.824751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5426254e-c3cb-48c0-803e-2edcd14d8214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC9DAC3A0>]}
[0m21:13:28.825751 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:13:29.082241 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m21:13:29.231202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m21:13:29.231202 [debug] [MainThread]: Partial parsing: added file: mochi_analysis://models\sources.yml
[0m21:13:29.231202 [debug] [MainThread]: Partial parsing: added file: mochi_analysis://models\Staging\stg_panel_evaluations.sql
[0m21:13:29.484510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5426254e-c3cb-48c0-803e-2edcd14d8214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACB645130>]}
[0m21:13:29.595448 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\manifest.json
[0m21:13:29.599982 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\semantic_manifest.json
[0m21:13:29.622260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5426254e-c3cb-48c0-803e-2edcd14d8214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACA59C760>]}
[0m21:13:29.622260 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 433 macros
[0m21:13:29.623260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5426254e-c3cb-48c0-803e-2edcd14d8214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACA3B34C0>]}
[0m21:13:29.624262 [info ] [MainThread]: 
[0m21:13:29.624262 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:13:29.624262 [info ] [MainThread]: 
[0m21:13:29.625261 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:13:29.629262 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mochi_data'
[0m21:13:29.709946 [debug] [ThreadPool]: Using postgres connection "list_mochi_data"
[0m21:13:29.709946 [debug] [ThreadPool]: On list_mochi_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "list_mochi_data"} */

    select distinct nspname from pg_namespace
  
[0m21:13:29.709946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:29.758300 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.038 seconds
[0m21:13:29.759300 [debug] [ThreadPool]: On list_mochi_data: Close
[0m21:13:29.759300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mochi_data, now create_mochi_data_dbt_mochi)
[0m21:13:29.760438 [debug] [ThreadPool]: Creating schema "database: "mochi_data"
schema: "dbt_mochi"
"
[0m21:13:29.760438 [debug] [ThreadPool]: Using postgres connection "create_mochi_data_dbt_mochi"
[0m21:13:29.760438 [debug] [ThreadPool]: On create_mochi_data_dbt_mochi: BEGIN
[0m21:13:29.760438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:13:29.790009 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m21:13:29.790009 [debug] [ThreadPool]: Using postgres connection "create_mochi_data_dbt_mochi"
[0m21:13:29.790009 [debug] [ThreadPool]: On create_mochi_data_dbt_mochi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "create_mochi_data_dbt_mochi"} */
create schema if not exists "dbt_mochi"
[0m21:13:29.793481 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m21:13:29.793481 [debug] [ThreadPool]: On create_mochi_data_dbt_mochi: COMMIT
[0m21:13:29.794482 [debug] [ThreadPool]: Using postgres connection "create_mochi_data_dbt_mochi"
[0m21:13:29.794482 [debug] [ThreadPool]: On create_mochi_data_dbt_mochi: COMMIT
[0m21:13:29.795920 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m21:13:29.795920 [debug] [ThreadPool]: On create_mochi_data_dbt_mochi: Close
[0m21:13:29.796922 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mochi_data_dbt_mochi'
[0m21:13:29.801923 [debug] [ThreadPool]: Using postgres connection "list_mochi_data_dbt_mochi"
[0m21:13:29.801923 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: BEGIN
[0m21:13:29.802923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:29.826901 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m21:13:29.827902 [debug] [ThreadPool]: Using postgres connection "list_mochi_data_dbt_mochi"
[0m21:13:29.827902 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "list_mochi_data_dbt_mochi"} */
select
      'mochi_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_mochi'
    union all
    select
      'mochi_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_mochi'
    union all
    select
      'mochi_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_mochi'
  
[0m21:13:29.832270 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m21:13:29.833272 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: ROLLBACK
[0m21:13:29.833272 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: Close
[0m21:13:29.836796 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:29.837224 [debug] [MainThread]: On master: BEGIN
[0m21:13:29.837224 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:13:29.861303 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m21:13:29.862303 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:29.862303 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:13:29.867550 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m21:13:29.868551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5426254e-c3cb-48c0-803e-2edcd14d8214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACA4E98E0>]}
[0m21:13:29.868551 [debug] [MainThread]: On master: ROLLBACK
[0m21:13:29.869551 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:29.869551 [debug] [MainThread]: On master: BEGIN
[0m21:13:29.870546 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:13:29.870546 [debug] [MainThread]: On master: COMMIT
[0m21:13:29.870546 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:29.870546 [debug] [MainThread]: On master: COMMIT
[0m21:13:29.871545 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:13:29.871545 [debug] [MainThread]: On master: Close
[0m21:13:29.874541 [debug] [Thread-1  ]: Began running node model.mochi_analysis.my_first_dbt_model
[0m21:13:29.875543 [info ] [Thread-1  ]: 1 of 3 START sql table model dbt_mochi.my_first_dbt_model ...................... [RUN]
[0m21:13:29.875543 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.mochi_analysis.my_first_dbt_model'
[0m21:13:29.876543 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.my_first_dbt_model
[0m21:13:29.882279 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.my_first_dbt_model"
[0m21:13:29.883980 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.my_first_dbt_model
[0m21:13:29.904611 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.my_first_dbt_model"
[0m21:13:29.904611 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m21:13:29.904611 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: BEGIN
[0m21:13:29.904611 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:13:29.939516 [debug] [Thread-1  ]: SQL status: BEGIN in 0.024 seconds
[0m21:13:29.939516 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m21:13:29.939516 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */

  
    

  create  table "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:13:29.949588 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.009 seconds
[0m21:13:29.956222 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m21:13:29.957222 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:13:29.957933 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:13:29.967936 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: COMMIT
[0m21:13:29.967936 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m21:13:29.968937 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: COMMIT
[0m21:13:29.969936 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m21:13:29.974545 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_backup"
[0m21:13:29.978584 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m21:13:29.978584 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
drop table if exists "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_backup" cascade
[0m21:13:29.979380 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m21:13:29.980382 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: Close
[0m21:13:29.982382 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5426254e-c3cb-48c0-803e-2edcd14d8214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC62D55E0>]}
[0m21:13:29.983383 [info ] [Thread-1  ]: 1 of 3 OK created sql table model dbt_mochi.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.11s]
[0m21:13:29.983383 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.my_first_dbt_model
[0m21:13:29.984381 [debug] [Thread-1  ]: Began running node model.mochi_analysis.stg_panel_evaluations
[0m21:13:29.984381 [info ] [Thread-1  ]: 2 of 3 START sql view model dbt_mochi.stg_panel_evaluations .................... [RUN]
[0m21:13:29.985383 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.my_first_dbt_model, now model.mochi_analysis.stg_panel_evaluations)
[0m21:13:29.985383 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.stg_panel_evaluations
[0m21:13:29.987237 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.stg_panel_evaluations"
[0m21:13:29.988236 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.stg_panel_evaluations
[0m21:13:30.000832 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.stg_panel_evaluations"
[0m21:13:30.001833 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m21:13:30.001833 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: BEGIN
[0m21:13:30.001833 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:13:30.022950 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m21:13:30.022950 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m21:13:30.022950 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */

  create view "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_tmp"
    
    
  as (
    -- models/staging/stg_panel_evaluations.sql

select *
from "mochi_data"."public"."raw_panel_evaluations"
  );
[0m21:13:30.022950 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m21:13:30.037745 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m21:13:30.037745 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
alter table "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_tmp" rename to "stg_panel_evaluations"
[0m21:13:30.037745 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:13:30.037745 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: COMMIT
[0m21:13:30.037745 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m21:13:30.037745 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: COMMIT
[0m21:13:30.037745 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m21:13:30.037745 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_backup"
[0m21:13:30.037745 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m21:13:30.037745 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
drop view if exists "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_backup" cascade
[0m21:13:30.037745 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m21:13:30.037745 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: Close
[0m21:13:30.037745 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5426254e-c3cb-48c0-803e-2edcd14d8214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC62D55E0>]}
[0m21:13:30.037745 [info ] [Thread-1  ]: 2 of 3 OK created sql view model dbt_mochi.stg_panel_evaluations ............... [[32mCREATE VIEW[0m in 0.05s]
[0m21:13:30.037745 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.stg_panel_evaluations
[0m21:13:30.037745 [debug] [Thread-1  ]: Began running node model.mochi_analysis.my_second_dbt_model
[0m21:13:30.037745 [info ] [Thread-1  ]: 3 of 3 START sql view model dbt_mochi.my_second_dbt_model ...................... [RUN]
[0m21:13:30.037745 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.stg_panel_evaluations, now model.mochi_analysis.my_second_dbt_model)
[0m21:13:30.037745 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.my_second_dbt_model
[0m21:13:30.037745 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.my_second_dbt_model"
[0m21:13:30.037745 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.my_second_dbt_model
[0m21:13:30.056871 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.my_second_dbt_model"
[0m21:13:30.058340 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m21:13:30.058340 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: BEGIN
[0m21:13:30.058340 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:13:30.078138 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m21:13:30.078138 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m21:13:30.078138 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */

  create view "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "mochi_data"."dbt_mochi"."my_first_dbt_model"
where id = 1
  );
[0m21:13:30.089165 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:13:30.090770 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m21:13:30.090770 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:13:30.090770 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:13:30.090770 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: COMMIT
[0m21:13:30.090770 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m21:13:30.090770 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: COMMIT
[0m21:13:30.090770 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m21:13:30.090770 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_backup"
[0m21:13:30.090770 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m21:13:30.090770 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */
drop view if exists "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_backup" cascade
[0m21:13:30.090770 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m21:13:30.090770 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: Close
[0m21:13:30.090770 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5426254e-c3cb-48c0-803e-2edcd14d8214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC62D55E0>]}
[0m21:13:30.090770 [info ] [Thread-1  ]: 3 of 3 OK created sql view model dbt_mochi.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.05s]
[0m21:13:30.090770 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.my_second_dbt_model
[0m21:13:30.090770 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:30.090770 [debug] [MainThread]: On master: BEGIN
[0m21:13:30.090770 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:13:30.127386 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m21:13:30.127386 [debug] [MainThread]: On master: COMMIT
[0m21:13:30.127386 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:30.127386 [debug] [MainThread]: On master: COMMIT
[0m21:13:30.127386 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:13:30.127386 [debug] [MainThread]: On master: Close
[0m21:13:30.127386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:13:30.127386 [debug] [MainThread]: Connection 'create_mochi_data_dbt_mochi' was properly closed.
[0m21:13:30.127386 [debug] [MainThread]: Connection 'list_mochi_data_dbt_mochi' was properly closed.
[0m21:13:30.127386 [debug] [MainThread]: Connection 'model.mochi_analysis.my_second_dbt_model' was properly closed.
[0m21:13:30.127386 [info ] [MainThread]: 
[0m21:13:30.127386 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m21:13:30.127386 [debug] [MainThread]: Command end result
[0m21:13:30.144261 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\manifest.json
[0m21:13:30.144261 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\semantic_manifest.json
[0m21:13:30.154832 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\run_results.json
[0m21:13:30.154832 [info ] [MainThread]: 
[0m21:13:30.155831 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:13:30.156434 [info ] [MainThread]: 
[0m21:13:30.156434 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:13:30.157433 [debug] [MainThread]: Command `dbt run` succeeded at 21:13:30.157433 after 1.58 seconds
[0m21:13:30.157433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC8D33250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACBACFF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACA3975E0>]}
[0m21:13:30.158433 [debug] [MainThread]: Flushing usage events
[0m21:13:31.154087 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:33:43.123841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002143FF43280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021441FB7700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021441FB7550>]}


============================== 18:33:43.123841 | 09062d87-3809-4d88-b81b-61dd81096fd6 ==============================
[0m18:33:43.123841 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:33:43.123841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\amiru\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\amiru\\Documents\\mochi_dbt\\mochi_analysis\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:33:43.344081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09062d87-3809-4d88-b81b-61dd81096fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021441F9D0D0>]}
[0m18:33:43.385203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09062d87-3809-4d88-b81b-61dd81096fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021441F8B5B0>]}
[0m18:33:43.386087 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:33:43.649646 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:33:43.864407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:33:43.864407 [debug] [MainThread]: Partial parsing: added file: mochi_analysis://models\fct_panel_evaluations_unpivoted.sql
[0m18:33:43.864407 [debug] [MainThread]: Partial parsing: updated file: mochi_analysis://models\Staging\stg_panel_evaluations.sql
[0m18:33:44.079151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09062d87-3809-4d88-b81b-61dd81096fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002144275FF70>]}
[0m18:33:44.146201 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\manifest.json
[0m18:33:44.146201 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\semantic_manifest.json
[0m18:33:44.226474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09062d87-3809-4d88-b81b-61dd81096fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214426592B0>]}
[0m18:33:44.226474 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 433 macros
[0m18:33:44.227475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09062d87-3809-4d88-b81b-61dd81096fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021442659880>]}
[0m18:33:44.228475 [info ] [MainThread]: 
[0m18:33:44.228475 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:33:44.229474 [info ] [MainThread]: 
[0m18:33:44.229474 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:33:44.234476 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mochi_data'
[0m18:33:44.409759 [debug] [ThreadPool]: Using postgres connection "list_mochi_data"
[0m18:33:44.409759 [debug] [ThreadPool]: On list_mochi_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "list_mochi_data"} */

    select distinct nspname from pg_namespace
  
[0m18:33:44.409759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:44.472263 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.070 seconds
[0m18:33:44.472263 [debug] [ThreadPool]: On list_mochi_data: Close
[0m18:33:44.472263 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mochi_data_dbt_mochi'
[0m18:33:44.472263 [debug] [ThreadPool]: Using postgres connection "list_mochi_data_dbt_mochi"
[0m18:33:44.487889 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: BEGIN
[0m18:33:44.487889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:44.503515 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m18:33:44.503515 [debug] [ThreadPool]: Using postgres connection "list_mochi_data_dbt_mochi"
[0m18:33:44.503515 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "list_mochi_data_dbt_mochi"} */
select
      'mochi_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_mochi'
    union all
    select
      'mochi_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_mochi'
    union all
    select
      'mochi_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_mochi'
  
[0m18:33:44.519141 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.017 seconds
[0m18:33:44.519141 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: ROLLBACK
[0m18:33:44.519141 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: Close
[0m18:33:44.534767 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:44.534767 [debug] [MainThread]: On master: BEGIN
[0m18:33:44.534767 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:33:44.550393 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m18:33:44.550393 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:44.550393 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:33:44.566019 [debug] [MainThread]: SQL status: SELECT 2 in 0.010 seconds
[0m18:33:44.566019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09062d87-3809-4d88-b81b-61dd81096fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021442618B20>]}
[0m18:33:44.566019 [debug] [MainThread]: On master: ROLLBACK
[0m18:33:44.566019 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:44.566019 [debug] [MainThread]: On master: BEGIN
[0m18:33:44.566019 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:33:44.566019 [debug] [MainThread]: On master: COMMIT
[0m18:33:44.566019 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:44.566019 [debug] [MainThread]: On master: COMMIT
[0m18:33:44.566019 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:33:44.566019 [debug] [MainThread]: On master: Close
[0m18:33:44.566019 [debug] [Thread-1  ]: Began running node model.mochi_analysis.my_first_dbt_model
[0m18:33:44.566019 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_mochi.my_first_dbt_model ...................... [RUN]
[0m18:33:44.566019 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.mochi_analysis.my_first_dbt_model'
[0m18:33:44.566019 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.my_first_dbt_model
[0m18:33:44.581645 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.my_first_dbt_model"
[0m18:33:44.581645 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.my_first_dbt_model
[0m18:33:44.614351 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.my_first_dbt_model"
[0m18:33:44.615727 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:33:44.615727 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: BEGIN
[0m18:33:44.615727 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:33:44.640702 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m18:33:44.641702 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:33:44.641702 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */

  
    

  create  table "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:33:44.654530 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.012 seconds
[0m18:33:44.661533 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:33:44.661533 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:33:44.663533 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:33:44.664540 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:33:44.664540 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:33:44.664540 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:33:44.664540 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: COMMIT
[0m18:33:44.664540 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:33:44.664540 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: COMMIT
[0m18:33:44.680165 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m18:33:44.680165 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_backup"
[0m18:33:44.680165 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:33:44.680165 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
drop table if exists "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_backup" cascade
[0m18:33:44.695790 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.008 seconds
[0m18:33:44.695790 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: Close
[0m18:33:44.695790 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09062d87-3809-4d88-b81b-61dd81096fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021443A59A00>]}
[0m18:33:44.695790 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_mochi.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.13s]
[0m18:33:44.695790 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.my_first_dbt_model
[0m18:33:44.695790 [debug] [Thread-1  ]: Began running node model.mochi_analysis.stg_panel_evaluations
[0m18:33:44.695790 [info ] [Thread-1  ]: 2 of 4 START sql view model dbt_mochi.stg_panel_evaluations .................... [RUN]
[0m18:33:44.695790 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.my_first_dbt_model, now model.mochi_analysis.stg_panel_evaluations)
[0m18:33:44.695790 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.stg_panel_evaluations
[0m18:33:44.695790 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.stg_panel_evaluations"
[0m18:33:44.695790 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.stg_panel_evaluations
[0m18:33:44.719045 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.stg_panel_evaluations"
[0m18:33:44.719045 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:33:44.719045 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: BEGIN
[0m18:33:44.719045 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:33:44.747258 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m18:33:44.748257 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:33:44.748257 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */

  create view "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_tmp"
    
    
  as (
    -- models/staging/stg_panel_evaluations.sql

select
    "Timestamp" as raw_timestamp, -- Keep raw timestamp for now, will format later
    "Bitterness" as bitterness_1,
    "Sweetness" as sweetness_1,
    "Chamomile_Flavour" as chamomile_flavour_1,
    "Honey_Flavour" as honey_flavour_1,
    "Creaminess" as creaminess_1,
    "Overall_Acceptability" as overall_acceptability_1,
    "Bitterness2" as bitterness_2,
    "Sweetness2" as sweetness_2,
    "Chamomile_Flavour2" as chamomile_flavour_2,
    "Honey_Flavour2" as honey_flavour_2,
    "Creaminess2" as creaminess_2,
    "Overall_Acceptability2" as overall_acceptability_2,
    "Bitterness3" as bitterness_3,
    "Sweetness3" as sweetness_3,
    "Chamomile_Flavour3" as chamomile_flavour_3,
    "Honey_Flavour3" as honey_flavour_3,
    "Creaminess3" as creaminess_3,
    "Overall_Acceptability3" as overall_acceptability_3,
    "Bitterness4" as bitterness_4,
    "Sweetness4" as sweetness_4,
    "Chamomile_Flavour4" as chamomile_flavour_4,
    "Honey_Flavour4" as honey_flavour_4,
    "Creaminess4" as creaminess_4,
    "Overall_Acceptability4" as overall_acceptability_4,
    "Bitterness5" as bitterness_5,
    "Sweetness5" as sweetness_5,
    "Chamomile_Flavour5" as chamomile_flavour_5,
    "Honey_Flavour5" as honey_flavour_5,
    "Creaminess5" as creaminess_5,
    "Overall_Acceptability5" as overall_acceptability_5
    -- Add any other relevant columns that don't need suffix, but remember to rename them
from "mochi_data"."public"."raw_panel_evaluations"
  );
[0m18:33:44.749731 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "Chamomile_Flavour" does not exist
LINE 13:     "Chamomile_Flavour" as chamomile_flavour_1,
             ^
HINT:  Perhaps you meant to reference the column "raw_panel_evaluations.Chamomile Flavour".

[0m18:33:44.749731 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: ROLLBACK
[0m18:33:44.749731 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: Close
[0m18:33:44.749731 [debug] [Thread-1  ]: Database Error in model stg_panel_evaluations (models\Staging\stg_panel_evaluations.sql)
  column "Chamomile_Flavour" does not exist
  LINE 13:     "Chamomile_Flavour" as chamomile_flavour_1,
               ^
  HINT:  Perhaps you meant to reference the column "raw_panel_evaluations.Chamomile Flavour".
  compiled code at target\run\mochi_analysis\models\Staging\stg_panel_evaluations.sql
[0m18:33:44.749731 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09062d87-3809-4d88-b81b-61dd81096fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021441292FA0>]}
[0m18:33:44.749731 [error] [Thread-1  ]: 2 of 4 ERROR creating sql view model dbt_mochi.stg_panel_evaluations ........... [[31mERROR[0m in 0.05s]
[0m18:33:44.749731 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.stg_panel_evaluations
[0m18:33:44.749731 [debug] [Thread-1  ]: Began running node model.mochi_analysis.my_second_dbt_model
[0m18:33:44.749731 [debug] [Thread-4  ]: Marking all children of 'model.mochi_analysis.stg_panel_evaluations' to be skipped because of status 'error'.  Reason: Database Error in model stg_panel_evaluations (models\Staging\stg_panel_evaluations.sql)
  column "Chamomile_Flavour" does not exist
  LINE 13:     "Chamomile_Flavour" as chamomile_flavour_1,
               ^
  HINT:  Perhaps you meant to reference the column "raw_panel_evaluations.Chamomile Flavour".
  compiled code at target\run\mochi_analysis\models\Staging\stg_panel_evaluations.sql.
[0m18:33:44.749731 [info ] [Thread-1  ]: 3 of 4 START sql view model dbt_mochi.my_second_dbt_model ...................... [RUN]
[0m18:33:44.749731 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.stg_panel_evaluations, now model.mochi_analysis.my_second_dbt_model)
[0m18:33:44.763924 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.my_second_dbt_model
[0m18:33:44.764467 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.my_second_dbt_model"
[0m18:33:44.764467 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.my_second_dbt_model
[0m18:33:44.764467 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.my_second_dbt_model"
[0m18:33:44.764467 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:33:44.764467 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: BEGIN
[0m18:33:44.764467 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:33:44.786841 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m18:33:44.786841 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:33:44.796876 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */

  create view "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "mochi_data"."dbt_mochi"."my_first_dbt_model"
where id = 1
  );
[0m18:33:44.801230 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m18:33:44.803229 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:33:44.804229 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:33:44.804229 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:33:44.805239 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: COMMIT
[0m18:33:44.805239 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:33:44.805239 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: COMMIT
[0m18:33:44.805239 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m18:33:44.807242 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_backup"
[0m18:33:44.807242 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:33:44.807242 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */
drop view if exists "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_backup" cascade
[0m18:33:44.807242 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m18:33:44.807242 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: Close
[0m18:33:44.807242 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09062d87-3809-4d88-b81b-61dd81096fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021441292FA0>]}
[0m18:33:44.807242 [info ] [Thread-1  ]: 3 of 4 OK created sql view model dbt_mochi.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.06s]
[0m18:33:44.813908 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.my_second_dbt_model
[0m18:33:44.813908 [debug] [Thread-1  ]: Began running node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m18:33:44.813908 [info ] [Thread-1  ]: 4 of 4 SKIP relation dbt_mochi.fct_panel_evaluations_unpivoted ................. [[33mSKIP[0m]
[0m18:33:44.814907 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m18:33:44.815907 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:44.816559 [debug] [MainThread]: On master: BEGIN
[0m18:33:44.816559 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:33:44.838083 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m18:33:44.838083 [debug] [MainThread]: On master: COMMIT
[0m18:33:44.838083 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:44.838083 [debug] [MainThread]: On master: COMMIT
[0m18:33:44.838083 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:33:44.838083 [debug] [MainThread]: On master: Close
[0m18:33:44.838083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:44.838083 [debug] [MainThread]: Connection 'list_mochi_data' was properly closed.
[0m18:33:44.838083 [debug] [MainThread]: Connection 'list_mochi_data_dbt_mochi' was properly closed.
[0m18:33:44.838083 [debug] [MainThread]: Connection 'model.mochi_analysis.my_second_dbt_model' was properly closed.
[0m18:33:44.838083 [info ] [MainThread]: 
[0m18:33:44.838083 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m18:33:44.846689 [debug] [MainThread]: Command end result
[0m18:33:44.863903 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\manifest.json
[0m18:33:44.865576 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\semantic_manifest.json
[0m18:33:44.871587 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\run_results.json
[0m18:33:44.871587 [info ] [MainThread]: 
[0m18:33:44.871587 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:33:44.871587 [info ] [MainThread]: 
[0m18:33:44.871587 [error] [MainThread]:   Database Error in model stg_panel_evaluations (models\Staging\stg_panel_evaluations.sql)
  column "Chamomile_Flavour" does not exist
  LINE 13:     "Chamomile_Flavour" as chamomile_flavour_1,
               ^
  HINT:  Perhaps you meant to reference the column "raw_panel_evaluations.Chamomile Flavour".
  compiled code at target\run\mochi_analysis\models\Staging\stg_panel_evaluations.sql
[0m18:33:44.871587 [info ] [MainThread]: 
[0m18:33:44.871587 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m18:33:44.871587 [debug] [MainThread]: Command `dbt run` failed at 18:33:44.871587 after 1.81 seconds
[0m18:33:44.871587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002143FF43280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021442618F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021442641250>]}
[0m18:33:44.871587 [debug] [MainThread]: Flushing usage events
[0m18:33:46.014129 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:43:06.422661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB5CD22B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB7D47730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB7D47580>]}


============================== 18:43:06.438288 | 99ecc3e6-0dc5-4a62-81b5-ee4e0eb02562 ==============================
[0m18:43:06.438288 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:43:06.438288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\amiru\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\amiru\\Documents\\mochi_dbt\\mochi_analysis\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:43:06.587577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99ecc3e6-0dc5-4a62-81b5-ee4e0eb02562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB4264190>]}
[0m18:43:06.634455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99ecc3e6-0dc5-4a62-81b5-ee4e0eb02562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB4383910>]}
[0m18:43:06.634455 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:43:06.889336 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:43:07.068461 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:43:07.068461 [debug] [MainThread]: Partial parsing: updated file: mochi_analysis://models\Staging\stg_panel_evaluations.sql
[0m18:43:07.256372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99ecc3e6-0dc5-4a62-81b5-ee4e0eb02562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB84EEEB0>]}
[0m18:43:07.339068 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\manifest.json
[0m18:43:07.339068 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\semantic_manifest.json
[0m18:43:07.385947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99ecc3e6-0dc5-4a62-81b5-ee4e0eb02562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB83C3070>]}
[0m18:43:07.385947 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 433 macros
[0m18:43:07.385947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99ecc3e6-0dc5-4a62-81b5-ee4e0eb02562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB83C3850>]}
[0m18:43:07.385947 [info ] [MainThread]: 
[0m18:43:07.385947 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:43:07.385947 [info ] [MainThread]: 
[0m18:43:07.385947 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:43:07.385947 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mochi_data'
[0m18:43:07.472842 [debug] [ThreadPool]: Using postgres connection "list_mochi_data"
[0m18:43:07.472842 [debug] [ThreadPool]: On list_mochi_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "list_mochi_data"} */

    select distinct nspname from pg_namespace
  
[0m18:43:07.472842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:07.504403 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.029 seconds
[0m18:43:07.504403 [debug] [ThreadPool]: On list_mochi_data: Close
[0m18:43:07.506403 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mochi_data_dbt_mochi'
[0m18:43:07.506991 [debug] [ThreadPool]: Using postgres connection "list_mochi_data_dbt_mochi"
[0m18:43:07.506991 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: BEGIN
[0m18:43:07.506991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:07.635940 [debug] [ThreadPool]: SQL status: BEGIN in 0.129 seconds
[0m18:43:07.635940 [debug] [ThreadPool]: Using postgres connection "list_mochi_data_dbt_mochi"
[0m18:43:07.635940 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "list_mochi_data_dbt_mochi"} */
select
      'mochi_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_mochi'
    union all
    select
      'mochi_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_mochi'
    union all
    select
      'mochi_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_mochi'
  
[0m18:43:07.635940 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m18:43:07.635940 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: ROLLBACK
[0m18:43:07.635940 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: Close
[0m18:43:07.635940 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:07.635940 [debug] [MainThread]: On master: BEGIN
[0m18:43:07.635940 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:43:07.667191 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m18:43:07.667191 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:07.667191 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:43:07.667191 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m18:43:07.667191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99ecc3e6-0dc5-4a62-81b5-ee4e0eb02562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB8333AC0>]}
[0m18:43:07.667191 [debug] [MainThread]: On master: ROLLBACK
[0m18:43:07.667191 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:07.667191 [debug] [MainThread]: On master: BEGIN
[0m18:43:07.667191 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:43:07.682818 [debug] [MainThread]: On master: COMMIT
[0m18:43:07.682818 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:07.682818 [debug] [MainThread]: On master: COMMIT
[0m18:43:07.682818 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:43:07.682818 [debug] [MainThread]: On master: Close
[0m18:43:07.682818 [debug] [Thread-1  ]: Began running node model.mochi_analysis.my_first_dbt_model
[0m18:43:07.682818 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_mochi.my_first_dbt_model ...................... [RUN]
[0m18:43:07.682818 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.mochi_analysis.my_first_dbt_model'
[0m18:43:07.682818 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.my_first_dbt_model
[0m18:43:07.682818 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.my_first_dbt_model"
[0m18:43:07.682818 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.my_first_dbt_model
[0m18:43:07.707436 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.my_first_dbt_model"
[0m18:43:07.707436 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:43:07.723061 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: BEGIN
[0m18:43:07.723061 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:43:07.747437 [debug] [Thread-1  ]: SQL status: BEGIN in 0.024 seconds
[0m18:43:07.747437 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:43:07.748438 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */

  
    

  create  table "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:43:07.751438 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.003 seconds
[0m18:43:07.757448 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:43:07.757448 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:43:07.757448 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:43:07.757448 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:43:07.757448 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:43:07.757448 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:43:07.773072 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: COMMIT
[0m18:43:07.773072 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:43:07.773072 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: COMMIT
[0m18:43:07.773072 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m18:43:07.773072 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_backup"
[0m18:43:07.773072 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:43:07.773072 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
drop table if exists "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_backup" cascade
[0m18:43:07.773072 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m18:43:07.773072 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: Close
[0m18:43:07.773072 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99ecc3e6-0dc5-4a62-81b5-ee4e0eb02562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB97F45E0>]}
[0m18:43:07.788698 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_mochi.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.09s]
[0m18:43:07.788698 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.my_first_dbt_model
[0m18:43:07.788698 [debug] [Thread-1  ]: Began running node model.mochi_analysis.stg_panel_evaluations
[0m18:43:07.788698 [info ] [Thread-1  ]: 2 of 4 START sql view model dbt_mochi.stg_panel_evaluations .................... [RUN]
[0m18:43:07.788698 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.my_first_dbt_model, now model.mochi_analysis.stg_panel_evaluations)
[0m18:43:07.788698 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.stg_panel_evaluations
[0m18:43:07.788698 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.stg_panel_evaluations"
[0m18:43:07.788698 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.stg_panel_evaluations
[0m18:43:07.808108 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.stg_panel_evaluations"
[0m18:43:07.809108 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:43:07.809108 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: BEGIN
[0m18:43:07.809108 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:43:07.936748 [debug] [Thread-1  ]: SQL status: BEGIN in 0.131 seconds
[0m18:43:07.936748 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:43:07.936748 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */

  create view "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_tmp"
    
    
  as (
    -- models/Staging/stg_panel_evaluations.sql

select
    "Timestamp" as raw_timestamp,
    -- Formulation 1 (original columns, likely without a suffix)
    "Bitterness" as bitterness_1,
    "Sweetness" as sweetness_1,
    "Chamomile Flavour" as chamomile_flavour_1,
    "Honey Flavour" as honey_flavour_1,         
    "Creaminess" as creaminess_1,               
    "Overall Acceptability" as overall_acceptability_1, 

    -- Formulation 2 (these will be .1 suffix if starting from 0 index, or .2 if first is 1)
    "Bitterness.1" as bitterness_2,           
    "Sweetness.1" as sweetness_2,               
    "Chamomile Flavour.1" as chamomile_flavour_2, 
    "Honey Flavour.1" as honey_flavour_2,
    "Creaminess.1" as creaminess_2,
    "Overall Acceptability.1" as overall_acceptability_2,

    -- Formulation 3 (these will be .2 suffix)
    "Bitterness.2" as bitterness_3,             
    "Sweetness.2" as sweetness_3,
    "Chamomile Flavour.2" as chamomile_flavour_3,
    "Honey Flavour.2" as honey_flavour_3,
    "Creaminess.2" as creaminess_3,
    "Overall Acceptability.2" as overall_acceptability_3,

    -- Formulation 4 (these will be .3 suffix)
    "Bitterness.3" as bitterness_4,
    "Sweetness.3" as sweetness_4,
    "Chamomile Flavour.3" as chamomile_flavour_4,
    "Honey Flavour.3" as honey_flavour_4,
    "Creaminess.3" as creaminess_4,
    "Overall Acceptability.3" as overall_acceptability_4,

    -- Formulation 5 (these will be .4 suffix)
    "Bitterness.4" as bitterness_5,
    "Sweetness.4" as sweetness_5,
    "Chamomile Flavour.4" as chamomile_flavour_5,
    "Honey Flavour.4" as honey_flavour_5,
    "Creaminess.4" as creaminess_5,
    "Overall Acceptability.4" as overall_acceptability_5

from "mochi_data"."public"."raw_panel_evaluations"
  );
[0m18:43:07.936748 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m18:43:07.936748 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:43:07.936748 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
alter table "mochi_data"."dbt_mochi"."stg_panel_evaluations" rename to "stg_panel_evaluations__dbt_backup"
[0m18:43:07.936748 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:43:07.936748 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:43:07.936748 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
alter table "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_tmp" rename to "stg_panel_evaluations"
[0m18:43:07.952374 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:43:07.952374 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: COMMIT
[0m18:43:07.952374 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:43:07.952374 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: COMMIT
[0m18:43:07.952374 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m18:43:07.952374 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_backup"
[0m18:43:07.952374 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:43:07.952374 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
drop view if exists "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_backup" cascade
[0m18:43:07.952374 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m18:43:07.952374 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: Close
[0m18:43:07.952374 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99ecc3e6-0dc5-4a62-81b5-ee4e0eb02562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB7010AC0>]}
[0m18:43:07.952374 [info ] [Thread-1  ]: 2 of 4 OK created sql view model dbt_mochi.stg_panel_evaluations ............... [[32mCREATE VIEW[0m in 0.16s]
[0m18:43:07.952374 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.stg_panel_evaluations
[0m18:43:07.952374 [debug] [Thread-1  ]: Began running node model.mochi_analysis.my_second_dbt_model
[0m18:43:07.952374 [info ] [Thread-1  ]: 3 of 4 START sql view model dbt_mochi.my_second_dbt_model ...................... [RUN]
[0m18:43:07.952374 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.stg_panel_evaluations, now model.mochi_analysis.my_second_dbt_model)
[0m18:43:07.952374 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.my_second_dbt_model
[0m18:43:07.952374 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.my_second_dbt_model"
[0m18:43:07.952374 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.my_second_dbt_model
[0m18:43:07.970592 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.my_second_dbt_model"
[0m18:43:07.971334 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:43:07.971517 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: BEGIN
[0m18:43:07.971517 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:43:07.996107 [debug] [Thread-1  ]: SQL status: BEGIN in 0.024 seconds
[0m18:43:07.996107 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:43:07.996107 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */

  create view "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "mochi_data"."dbt_mochi"."my_first_dbt_model"
where id = 1
  );
[0m18:43:07.997118 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:43:07.997118 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:43:07.997118 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:43:07.997118 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:43:07.997118 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: COMMIT
[0m18:43:07.997118 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:43:07.997118 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: COMMIT
[0m18:43:07.997118 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m18:43:07.997118 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_backup"
[0m18:43:08.006978 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:43:08.007541 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */
drop view if exists "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_backup" cascade
[0m18:43:08.007541 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m18:43:08.007541 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: Close
[0m18:43:08.007541 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99ecc3e6-0dc5-4a62-81b5-ee4e0eb02562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB98D5E80>]}
[0m18:43:08.007541 [info ] [Thread-1  ]: 3 of 4 OK created sql view model dbt_mochi.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.06s]
[0m18:43:08.007541 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.my_second_dbt_model
[0m18:43:08.007541 [debug] [Thread-1  ]: Began running node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m18:43:08.007541 [info ] [Thread-1  ]: 4 of 4 START sql view model dbt_mochi.fct_panel_evaluations_unpivoted .......... [RUN]
[0m18:43:08.007541 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.my_second_dbt_model, now model.mochi_analysis.fct_panel_evaluations_unpivoted)
[0m18:43:08.007541 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m18:43:08.007541 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m18:43:08.007541 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m18:43:08.007541 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m18:43:08.007541 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m18:43:08.007541 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: BEGIN
[0m18:43:08.007541 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:43:08.155296 [debug] [Thread-1  ]: SQL status: BEGIN in 0.139 seconds
[0m18:43:08.155296 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m18:43:08.155296 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.fct_panel_evaluations_unpivoted"} */

  create view "mochi_data"."dbt_mochi"."fct_panel_evaluations_unpivoted__dbt_tmp"
    
    
  as (
    -- models/fct_panel_evaluations_unpivoted.sql

SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    'Formulation 1' AS flavour_name,
    bitterness_1 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_1, STRPOS(sweetness_1, '(') + 1, STRPOS(sweetness_1, ')') - STRPOS(sweetness_1, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_1, STRPOS(chamomile_flavour_1, '(') + 1, STRPOS(chamomile_flavour_1, ')') - STRPOS(chamomile_flavour_1, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_1, STRPOS(honey_flavour_1, '(') + 1, STRPOS(honey_flavour_1, ')') - STRPOS(honey_flavour_1, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_1, STRPOS(creaminess_1, '(') + 1, STRPOS(creaminess_1, ')') - STRPOS(creaminess_1, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_1 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    'Formulation 2' AS flavour_name,
    bitterness_2 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_2, STRPOS(sweetness_2, '(') + 1, STRPOS(sweetness_2, ')') - STRPOS(sweetness_2, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_2, STRPOS(chamomile_flavour_2, '(') + 1, STRPOS(chamomile_flavour_2, ')') - STRPOS(chamomile_flavour_2, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_2, STRPOS(honey_flavour_2, '(') + 1, STRPOS(honey_flavour_2, ')') - STRPOS(honey_flavour_2, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_2, STRPOS(creaminess_2, '(') + 1, STRPOS(creaminess_2, ')') - STRPOS(creaminess_2, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_2 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

-- Repeat for Flavor 3
SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    'Formulation 3' AS flavour_name,
    bitterness_3 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_3, STRPOS(sweetness_3, '(') + 1, STRPOS(sweetness_3, ')') - STRPOS(sweetness_3, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_3, STRPOS(chamomile_flavour_3, '(') + 1, STRPOS(chamomile_flavour_3, ')') - STRPOS(chamomile_flavour_3, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_3, STRPOS(honey_flavour_3, '(') + 1, STRPOS(honey_flavour_3, ')') - STRPOS(honey_flavour_3, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_3, STRPOS(creaminess_3, '(') + 1, STRPOS(creaminess_3, ')') - STRPOS(creaminess_3, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_3 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

-- Repeat for Flavor 4
SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    'Formulation 4' AS flavour_name,
    bitterness_4 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_4, STRPOS(sweetness_4, '(') + 1, STRPOS(sweetness_4, ')') - STRPOS(sweetness_4, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_4, STRPOS(chamomile_flavour_4, '(') + 1, STRPOS(chamomile_flavour_4, ')') - STRPOS(chamomile_flavour_4, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_4, STRPOS(honey_flavour_4, '(') + 1, STRPOS(honey_flavour_4, ')') - STRPOS(honey_flavour_4, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_4, STRPOS(creaminess_4, '(') + 1, STRPOS(creaminess_4, ')') - STRPOS(creaminess_4, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_4 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

-- Repeat for Flavor 5
SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    'Formulation 5' AS flavour_name,
    bitterness_5 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_5, STRPOS(sweetness_5, '(') + 1, STRPOS(sweetness_5, ')') - STRPOS(sweetness_5, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_5, STRPOS(chamomile_flavour_5, '(') + 1, STRPOS(chamomile_flavour_5, ')') - STRPOS(chamomile_flavour_5, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_5, STRPOS(honey_flavour_5, '(') + 1, STRPOS(honey_flavour_5, ')') - STRPOS(honey_flour_5, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_5, STRPOS(creaminess_5, '(') + 1, STRPOS(creaminess_5, ')') - STRPOS(creaminess_5, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_5 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1
  );
[0m18:43:08.155296 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "honey_flour_5" does not exist
LINE 82: ..., '(') + 1, STRPOS(honey_flavour_5, ')') - STRPOS(honey_flou...
                                                              ^
HINT:  Perhaps you meant to reference the column "stg_panel_evaluations.honey_flavour_5".

[0m18:43:08.155296 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: ROLLBACK
[0m18:43:08.155296 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: Close
[0m18:43:08.155296 [debug] [Thread-1  ]: Database Error in model fct_panel_evaluations_unpivoted (models\fct_panel_evaluations_unpivoted.sql)
  column "honey_flour_5" does not exist
  LINE 82: ..., '(') + 1, STRPOS(honey_flavour_5, ')') - STRPOS(honey_flou...
                                                                ^
  HINT:  Perhaps you meant to reference the column "stg_panel_evaluations.honey_flavour_5".
  compiled code at target\run\mochi_analysis\models\fct_panel_evaluations_unpivoted.sql
[0m18:43:08.155296 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99ecc3e6-0dc5-4a62-81b5-ee4e0eb02562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB9A18F70>]}
[0m18:43:08.155296 [error] [Thread-1  ]: 4 of 4 ERROR creating sql view model dbt_mochi.fct_panel_evaluations_unpivoted . [[31mERROR[0m in 0.15s]
[0m18:43:08.155296 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m18:43:08.155296 [debug] [Thread-4  ]: Marking all children of 'model.mochi_analysis.fct_panel_evaluations_unpivoted' to be skipped because of status 'error'.  Reason: Database Error in model fct_panel_evaluations_unpivoted (models\fct_panel_evaluations_unpivoted.sql)
  column "honey_flour_5" does not exist
  LINE 82: ..., '(') + 1, STRPOS(honey_flavour_5, ')') - STRPOS(honey_flou...
                                                                ^
  HINT:  Perhaps you meant to reference the column "stg_panel_evaluations.honey_flavour_5".
  compiled code at target\run\mochi_analysis\models\fct_panel_evaluations_unpivoted.sql.
[0m18:43:08.170922 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:08.170922 [debug] [MainThread]: On master: BEGIN
[0m18:43:08.170922 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:43:08.193817 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m18:43:08.193817 [debug] [MainThread]: On master: COMMIT
[0m18:43:08.193817 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:08.193817 [debug] [MainThread]: On master: COMMIT
[0m18:43:08.193817 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:43:08.193817 [debug] [MainThread]: On master: Close
[0m18:43:08.193817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:08.193817 [debug] [MainThread]: Connection 'list_mochi_data' was properly closed.
[0m18:43:08.193817 [debug] [MainThread]: Connection 'list_mochi_data_dbt_mochi' was properly closed.
[0m18:43:08.193817 [debug] [MainThread]: Connection 'model.mochi_analysis.fct_panel_evaluations_unpivoted' was properly closed.
[0m18:43:08.193817 [info ] [MainThread]: 
[0m18:43:08.193817 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m18:43:08.193817 [debug] [MainThread]: Command end result
[0m18:43:08.214529 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\manifest.json
[0m18:43:08.214529 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\semantic_manifest.json
[0m18:43:08.226001 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\run_results.json
[0m18:43:08.227001 [info ] [MainThread]: 
[0m18:43:08.227001 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:43:08.227001 [info ] [MainThread]: 
[0m18:43:08.228001 [error] [MainThread]:   Database Error in model fct_panel_evaluations_unpivoted (models\fct_panel_evaluations_unpivoted.sql)
  column "honey_flour_5" does not exist
  LINE 82: ..., '(') + 1, STRPOS(honey_flavour_5, ')') - STRPOS(honey_flou...
                                                                ^
  HINT:  Perhaps you meant to reference the column "stg_panel_evaluations.honey_flavour_5".
  compiled code at target\run\mochi_analysis\models\fct_panel_evaluations_unpivoted.sql
[0m18:43:08.228001 [info ] [MainThread]: 
[0m18:43:08.229001 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:43:08.230002 [debug] [MainThread]: Command `dbt run` failed at 18:43:08.230002 after 1.85 seconds
[0m18:43:08.230002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB5CD22B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB8403B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB8454D90>]}
[0m18:43:08.230002 [debug] [MainThread]: Flushing usage events
[0m18:43:09.187570 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:44:56.178523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B02DDA41F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B02EE47610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B02EE47460>]}


============================== 18:44:56.178523 | c0b60058-898a-488e-acca-d4d2e716080b ==============================
[0m18:44:56.178523 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:44:56.178523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\amiru\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\amiru\\Documents\\mochi_dbt\\mochi_analysis\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:44:56.333447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0b60058-898a-488e-acca-d4d2e716080b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B02EE115E0>]}
[0m18:44:56.376422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0b60058-898a-488e-acca-d4d2e716080b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B02EF661C0>]}
[0m18:44:56.377377 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:44:56.638835 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:44:56.786224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:44:56.786224 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:44:56.838001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0b60058-898a-488e-acca-d4d2e716080b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B02F426EB0>]}
[0m18:44:56.919109 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\manifest.json
[0m18:44:56.919448 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\semantic_manifest.json
[0m18:44:56.935937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0b60058-898a-488e-acca-d4d2e716080b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B02F017EB0>]}
[0m18:44:56.935937 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 433 macros
[0m18:44:56.935937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0b60058-898a-488e-acca-d4d2e716080b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B02F427070>]}
[0m18:44:56.935937 [info ] [MainThread]: 
[0m18:44:56.935937 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:44:56.935937 [info ] [MainThread]: 
[0m18:44:56.935937 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:44:56.935937 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mochi_data'
[0m18:44:57.003629 [debug] [ThreadPool]: Using postgres connection "list_mochi_data"
[0m18:44:57.003629 [debug] [ThreadPool]: On list_mochi_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "list_mochi_data"} */

    select distinct nspname from pg_namespace
  
[0m18:44:57.003629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:57.038409 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.029 seconds
[0m18:44:57.038409 [debug] [ThreadPool]: On list_mochi_data: Close
[0m18:44:57.038409 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mochi_data_dbt_mochi'
[0m18:44:57.052411 [debug] [ThreadPool]: Using postgres connection "list_mochi_data_dbt_mochi"
[0m18:44:57.052411 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: BEGIN
[0m18:44:57.052411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:57.070258 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m18:44:57.070258 [debug] [ThreadPool]: Using postgres connection "list_mochi_data_dbt_mochi"
[0m18:44:57.070258 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "list_mochi_data_dbt_mochi"} */
select
      'mochi_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_mochi'
    union all
    select
      'mochi_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_mochi'
    union all
    select
      'mochi_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_mochi'
  
[0m18:44:57.079261 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m18:44:57.079261 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: ROLLBACK
[0m18:44:57.079261 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: Close
[0m18:44:57.103853 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:57.103853 [debug] [MainThread]: On master: BEGIN
[0m18:44:57.103853 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:44:57.136536 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m18:44:57.136536 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:57.136536 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:44:57.136536 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m18:44:57.136536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0b60058-898a-488e-acca-d4d2e716080b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B02F8A5250>]}
[0m18:44:57.136536 [debug] [MainThread]: On master: ROLLBACK
[0m18:44:57.136536 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:57.136536 [debug] [MainThread]: On master: BEGIN
[0m18:44:57.136536 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:44:57.136536 [debug] [MainThread]: On master: COMMIT
[0m18:44:57.136536 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:57.136536 [debug] [MainThread]: On master: COMMIT
[0m18:44:57.136536 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:44:57.136536 [debug] [MainThread]: On master: Close
[0m18:44:57.153035 [debug] [Thread-1  ]: Began running node model.mochi_analysis.my_first_dbt_model
[0m18:44:57.153035 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_mochi.my_first_dbt_model ...................... [RUN]
[0m18:44:57.153035 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.mochi_analysis.my_first_dbt_model'
[0m18:44:57.153035 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.my_first_dbt_model
[0m18:44:57.153035 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.my_first_dbt_model"
[0m18:44:57.153035 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.my_first_dbt_model
[0m18:44:57.189967 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.my_first_dbt_model"
[0m18:44:57.189967 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:44:57.189967 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: BEGIN
[0m18:44:57.189967 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:44:57.207348 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m18:44:57.207348 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:44:57.207348 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */

  
    

  create  table "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:44:57.219968 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.003 seconds
[0m18:44:57.219968 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:44:57.219968 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:44:57.219968 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:44:57.219968 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:44:57.219968 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:44:57.219968 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:44:57.237012 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: COMMIT
[0m18:44:57.237012 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:44:57.237012 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: COMMIT
[0m18:44:57.237012 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m18:44:57.252416 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_backup"
[0m18:44:57.253288 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:44:57.253288 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
drop table if exists "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_backup" cascade
[0m18:44:57.253288 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m18:44:57.253288 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: Close
[0m18:44:57.253288 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0b60058-898a-488e-acca-d4d2e716080b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B02B348580>]}
[0m18:44:57.253288 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_mochi.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.10s]
[0m18:44:57.253288 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.my_first_dbt_model
[0m18:44:57.253288 [debug] [Thread-1  ]: Began running node model.mochi_analysis.stg_panel_evaluations
[0m18:44:57.253288 [info ] [Thread-1  ]: 2 of 4 START sql view model dbt_mochi.stg_panel_evaluations .................... [RUN]
[0m18:44:57.253288 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.my_first_dbt_model, now model.mochi_analysis.stg_panel_evaluations)
[0m18:44:57.253288 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.stg_panel_evaluations
[0m18:44:57.253288 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.stg_panel_evaluations"
[0m18:44:57.253288 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.stg_panel_evaluations
[0m18:44:57.275393 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.stg_panel_evaluations"
[0m18:44:57.275393 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:44:57.275393 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: BEGIN
[0m18:44:57.275393 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:44:57.307073 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m18:44:57.308074 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:44:57.308074 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */

  create view "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_tmp"
    
    
  as (
    -- models/Staging/stg_panel_evaluations.sql

select
    "Timestamp" as raw_timestamp,
    -- Formulation 1 (original columns, likely without a suffix)
    "Bitterness" as bitterness_1,
    "Sweetness" as sweetness_1,
    "Chamomile Flavour" as chamomile_flavour_1,
    "Honey Flavour" as honey_flavour_1,         
    "Creaminess" as creaminess_1,               
    "Overall Acceptability" as overall_acceptability_1, 

    -- Formulation 2 (these will be .1 suffix if starting from 0 index, or .2 if first is 1)
    "Bitterness.1" as bitterness_2,           
    "Sweetness.1" as sweetness_2,               
    "Chamomile Flavour.1" as chamomile_flavour_2, 
    "Honey Flavour.1" as honey_flavour_2,
    "Creaminess.1" as creaminess_2,
    "Overall Acceptability.1" as overall_acceptability_2,

    -- Formulation 3 (these will be .2 suffix)
    "Bitterness.2" as bitterness_3,             
    "Sweetness.2" as sweetness_3,
    "Chamomile Flavour.2" as chamomile_flavour_3,
    "Honey Flavour.2" as honey_flavour_3,
    "Creaminess.2" as creaminess_3,
    "Overall Acceptability.2" as overall_acceptability_3,

    -- Formulation 4 (these will be .3 suffix)
    "Bitterness.3" as bitterness_4,
    "Sweetness.3" as sweetness_4,
    "Chamomile Flavour.3" as chamomile_flavour_4,
    "Honey Flavour.3" as honey_flavour_4,
    "Creaminess.3" as creaminess_4,
    "Overall Acceptability.3" as overall_acceptability_4,

    -- Formulation 5 (these will be .4 suffix)
    "Bitterness.4" as bitterness_5,
    "Sweetness.4" as sweetness_5,
    "Chamomile Flavour.4" as chamomile_flavour_5,
    "Honey Flavour.4" as honey_flavour_5,
    "Creaminess.4" as creaminess_5,
    "Overall Acceptability.4" as overall_acceptability_5

from "mochi_data"."public"."raw_panel_evaluations"
  );
[0m18:44:57.309081 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m18:44:57.309081 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:44:57.309081 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
alter table "mochi_data"."dbt_mochi"."stg_panel_evaluations" rename to "stg_panel_evaluations__dbt_backup"
[0m18:44:57.309081 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:44:57.309081 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:44:57.309081 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
alter table "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_tmp" rename to "stg_panel_evaluations"
[0m18:44:57.319065 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:44:57.320031 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: COMMIT
[0m18:44:57.320031 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:44:57.321030 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: COMMIT
[0m18:44:57.322031 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m18:44:57.323042 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_backup"
[0m18:44:57.323042 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:44:57.323042 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
drop view if exists "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_backup" cascade
[0m18:44:57.323042 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m18:44:57.323042 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: Close
[0m18:44:57.323042 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0b60058-898a-488e-acca-d4d2e716080b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B02E128070>]}
[0m18:44:57.323042 [info ] [Thread-1  ]: 2 of 4 OK created sql view model dbt_mochi.stg_panel_evaluations ............... [[32mCREATE VIEW[0m in 0.07s]
[0m18:44:57.323042 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.stg_panel_evaluations
[0m18:44:57.323042 [debug] [Thread-1  ]: Began running node model.mochi_analysis.my_second_dbt_model
[0m18:44:57.323042 [info ] [Thread-1  ]: 3 of 4 START sql view model dbt_mochi.my_second_dbt_model ...................... [RUN]
[0m18:44:57.323042 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.stg_panel_evaluations, now model.mochi_analysis.my_second_dbt_model)
[0m18:44:57.323042 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.my_second_dbt_model
[0m18:44:57.323042 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.my_second_dbt_model"
[0m18:44:57.323042 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.my_second_dbt_model
[0m18:44:57.336856 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.my_second_dbt_model"
[0m18:44:57.337855 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:44:57.337855 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: BEGIN
[0m18:44:57.338856 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:44:57.469228 [debug] [Thread-1  ]: SQL status: BEGIN in 0.133 seconds
[0m18:44:57.469228 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:44:57.469228 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */

  create view "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "mochi_data"."dbt_mochi"."my_first_dbt_model"
where id = 1
  );
[0m18:44:57.469228 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:44:57.469228 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:44:57.469228 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:44:57.469228 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:44:57.469228 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: COMMIT
[0m18:44:57.469228 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:44:57.469228 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: COMMIT
[0m18:44:57.469228 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m18:44:57.469228 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_backup"
[0m18:44:57.469228 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:44:57.469228 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */
drop view if exists "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_backup" cascade
[0m18:44:57.469228 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m18:44:57.484854 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: Close
[0m18:44:57.484854 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0b60058-898a-488e-acca-d4d2e716080b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B02F989E50>]}
[0m18:44:57.485970 [info ] [Thread-1  ]: 3 of 4 OK created sql view model dbt_mochi.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.16s]
[0m18:44:57.485970 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.my_second_dbt_model
[0m18:44:57.485970 [debug] [Thread-1  ]: Began running node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m18:44:57.485970 [info ] [Thread-1  ]: 4 of 4 START sql view model dbt_mochi.fct_panel_evaluations_unpivoted .......... [RUN]
[0m18:44:57.485970 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.my_second_dbt_model, now model.mochi_analysis.fct_panel_evaluations_unpivoted)
[0m18:44:57.485970 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m18:44:57.485970 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m18:44:57.485970 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m18:44:57.485970 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m18:44:57.485970 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m18:44:57.485970 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: BEGIN
[0m18:44:57.485970 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:44:57.521252 [debug] [Thread-1  ]: SQL status: BEGIN in 0.026 seconds
[0m18:44:57.521252 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m18:44:57.522252 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.fct_panel_evaluations_unpivoted"} */

  create view "mochi_data"."dbt_mochi"."fct_panel_evaluations_unpivoted__dbt_tmp"
    
    
  as (
    -- models/fct_panel_evaluations_unpivoted.sql

SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    'Formulation 1' AS flavour_name,
    bitterness_1 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_1, STRPOS(sweetness_1, '(') + 1, STRPOS(sweetness_1, ')') - STRPOS(sweetness_1, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_1, STRPOS(chamomile_flavour_1, '(') + 1, STRPOS(chamomile_flavour_1, ')') - STRPOS(chamomile_flavour_1, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_1, STRPOS(honey_flavour_1, '(') + 1, STRPOS(honey_flavour_1, ')') - STRPOS(honey_flavour_1, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_1, STRPOS(creaminess_1, '(') + 1, STRPOS(creaminess_1, ')') - STRPOS(creaminess_1, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_1 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    'Formulation 2' AS flavour_name,
    bitterness_2 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_2, STRPOS(sweetness_2, '(') + 1, STRPOS(sweetness_2, ')') - STRPOS(sweetness_2, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_2, STRPOS(chamomile_flavour_2, '(') + 1, STRPOS(chamomile_flavour_2, ')') - STRPOS(chamomile_flavour_2, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_2, STRPOS(honey_flavour_2, '(') + 1, STRPOS(honey_flavour_2, ')') - STRPOS(honey_flavour_2, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_2, STRPOS(creaminess_2, '(') + 1, STRPOS(creaminess_2, ')') - STRPOS(creaminess_2, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_2 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

-- Repeat for Flavor 3
SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    'Formulation 3' AS flavour_name,
    bitterness_3 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_3, STRPOS(sweetness_3, '(') + 1, STRPOS(sweetness_3, ')') - STRPOS(sweetness_3, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_3, STRPOS(chamomile_flavour_3, '(') + 1, STRPOS(chamomile_flavour_3, ')') - STRPOS(chamomile_flavour_3, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_3, STRPOS(honey_flavour_3, '(') + 1, STRPOS(honey_flavour_3, ')') - STRPOS(honey_flavour_3, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_3, STRPOS(creaminess_3, '(') + 1, STRPOS(creaminess_3, ')') - STRPOS(creaminess_3, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_3 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

-- Repeat for Flavor 4
SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    'Formulation 4' AS flavour_name,
    bitterness_4 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_4, STRPOS(sweetness_4, '(') + 1, STRPOS(sweetness_4, ')') - STRPOS(sweetness_4, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_4, STRPOS(chamomile_flavour_4, '(') + 1, STRPOS(chamomile_flavour_4, ')') - STRPOS(chamomile_flavour_4, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_4, STRPOS(honey_flavour_4, '(') + 1, STRPOS(honey_flavour_4, ')') - STRPOS(honey_flavour_4, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_4, STRPOS(creaminess_4, '(') + 1, STRPOS(creaminess_4, ')') - STRPOS(creaminess_4, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_4 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

-- Repeat for Flavor 5
SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    'Formulation 5' AS flavour_name,
    bitterness_5 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_5, STRPOS(sweetness_5, '(') + 1, STRPOS(sweetness_5, ')') - STRPOS(sweetness_5, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_5, STRPOS(chamomile_flavour_5, '(') + 1, STRPOS(chamomile_flavour_5, ')') - STRPOS(chamomile_flavour_5, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_5, STRPOS(honey_flavour_5, '(') + 1, STRPOS(honey_flavour_5, ')') - STRPOS(honey_flour_5, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_5, STRPOS(creaminess_5, '(') + 1, STRPOS(creaminess_5, ')') - STRPOS(creaminess_5, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_5 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1
  );
[0m18:44:57.524253 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "honey_flour_5" does not exist
LINE 82: ..., '(') + 1, STRPOS(honey_flavour_5, ')') - STRPOS(honey_flou...
                                                              ^
HINT:  Perhaps you meant to reference the column "stg_panel_evaluations.honey_flavour_5".

[0m18:44:57.524580 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: ROLLBACK
[0m18:44:57.524580 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: Close
[0m18:44:57.526592 [debug] [Thread-1  ]: Database Error in model fct_panel_evaluations_unpivoted (models\fct_panel_evaluations_unpivoted.sql)
  column "honey_flour_5" does not exist
  LINE 82: ..., '(') + 1, STRPOS(honey_flavour_5, ')') - STRPOS(honey_flou...
                                                                ^
  HINT:  Perhaps you meant to reference the column "stg_panel_evaluations.honey_flavour_5".
  compiled code at target\run\mochi_analysis\models\fct_panel_evaluations_unpivoted.sql
[0m18:44:57.526592 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0b60058-898a-488e-acca-d4d2e716080b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B02F989E50>]}
[0m18:44:57.526592 [error] [Thread-1  ]: 4 of 4 ERROR creating sql view model dbt_mochi.fct_panel_evaluations_unpivoted . [[31mERROR[0m in 0.04s]
[0m18:44:57.526592 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m18:44:57.526592 [debug] [Thread-4  ]: Marking all children of 'model.mochi_analysis.fct_panel_evaluations_unpivoted' to be skipped because of status 'error'.  Reason: Database Error in model fct_panel_evaluations_unpivoted (models\fct_panel_evaluations_unpivoted.sql)
  column "honey_flour_5" does not exist
  LINE 82: ..., '(') + 1, STRPOS(honey_flavour_5, ')') - STRPOS(honey_flou...
                                                                ^
  HINT:  Perhaps you meant to reference the column "stg_panel_evaluations.honey_flavour_5".
  compiled code at target\run\mochi_analysis\models\fct_panel_evaluations_unpivoted.sql.
[0m18:44:57.526592 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:57.526592 [debug] [MainThread]: On master: BEGIN
[0m18:44:57.526592 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:44:57.553758 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m18:44:57.553758 [debug] [MainThread]: On master: COMMIT
[0m18:44:57.553758 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:57.553758 [debug] [MainThread]: On master: COMMIT
[0m18:44:57.553758 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:44:57.553758 [debug] [MainThread]: On master: Close
[0m18:44:57.553758 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:57.553758 [debug] [MainThread]: Connection 'list_mochi_data' was properly closed.
[0m18:44:57.553758 [debug] [MainThread]: Connection 'list_mochi_data_dbt_mochi' was properly closed.
[0m18:44:57.553758 [debug] [MainThread]: Connection 'model.mochi_analysis.fct_panel_evaluations_unpivoted' was properly closed.
[0m18:44:57.553758 [info ] [MainThread]: 
[0m18:44:57.553758 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m18:44:57.553758 [debug] [MainThread]: Command end result
[0m18:44:57.576318 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\manifest.json
[0m18:44:57.576318 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\semantic_manifest.json
[0m18:44:57.585720 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\run_results.json
[0m18:44:57.585720 [info ] [MainThread]: 
[0m18:44:57.585720 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:44:57.586718 [info ] [MainThread]: 
[0m18:44:57.586718 [error] [MainThread]:   Database Error in model fct_panel_evaluations_unpivoted (models\fct_panel_evaluations_unpivoted.sql)
  column "honey_flour_5" does not exist
  LINE 82: ..., '(') + 1, STRPOS(honey_flavour_5, ')') - STRPOS(honey_flou...
                                                                ^
  HINT:  Perhaps you meant to reference the column "stg_panel_evaluations.honey_flavour_5".
  compiled code at target\run\mochi_analysis\models\fct_panel_evaluations_unpivoted.sql
[0m18:44:57.587718 [info ] [MainThread]: 
[0m18:44:57.588288 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:44:57.588448 [debug] [MainThread]: Command `dbt run` failed at 18:44:57.588448 after 1.46 seconds
[0m18:44:57.589447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B02DDA41F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B02E162C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B02EF4B3D0>]}
[0m18:44:57.589447 [debug] [MainThread]: Flushing usage events
[0m18:44:58.519616 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:45:26.319265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168D8832B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168F8F68E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168F8F6A90>]}


============================== 18:45:26.322266 | ff474e65-1263-40c5-94ce-7d950c62afc9 ==============================
[0m18:45:26.322266 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:45:26.322266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\amiru\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\amiru\\Documents\\mochi_dbt\\mochi_analysis\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:45:26.469603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff474e65-1263-40c5-94ce-7d950c62afc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168BE00190>]}
[0m18:45:26.511484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff474e65-1263-40c5-94ce-7d950c62afc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168BF32910>]}
[0m18:45:26.512658 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:45:26.774846 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:45:26.914679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:45:26.914679 [debug] [MainThread]: Partial parsing: updated file: mochi_analysis://models\fct_panel_evaluations_unpivoted.sql
[0m18:45:27.115329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff474e65-1263-40c5-94ce-7d950c62afc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002169009EE50>]}
[0m18:45:27.190281 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\manifest.json
[0m18:45:27.192828 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\semantic_manifest.json
[0m18:45:27.235168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff474e65-1263-40c5-94ce-7d950c62afc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168FF49F10>]}
[0m18:45:27.235168 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 433 macros
[0m18:45:27.235168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff474e65-1263-40c5-94ce-7d950c62afc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168FF49FA0>]}
[0m18:45:27.235168 [info ] [MainThread]: 
[0m18:45:27.235168 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:45:27.235168 [info ] [MainThread]: 
[0m18:45:27.235168 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:45:27.235168 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mochi_data'
[0m18:45:27.301917 [debug] [ThreadPool]: Using postgres connection "list_mochi_data"
[0m18:45:27.301917 [debug] [ThreadPool]: On list_mochi_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "list_mochi_data"} */

    select distinct nspname from pg_namespace
  
[0m18:45:27.301917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:27.339604 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.028 seconds
[0m18:45:27.340604 [debug] [ThreadPool]: On list_mochi_data: Close
[0m18:45:27.341604 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mochi_data_dbt_mochi'
[0m18:45:27.346606 [debug] [ThreadPool]: Using postgres connection "list_mochi_data_dbt_mochi"
[0m18:45:27.346606 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: BEGIN
[0m18:45:27.346606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:27.479247 [debug] [ThreadPool]: SQL status: BEGIN in 0.136 seconds
[0m18:45:27.479247 [debug] [ThreadPool]: Using postgres connection "list_mochi_data_dbt_mochi"
[0m18:45:27.479247 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "list_mochi_data_dbt_mochi"} */
select
      'mochi_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_mochi'
    union all
    select
      'mochi_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_mochi'
    union all
    select
      'mochi_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_mochi'
  
[0m18:45:27.479247 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m18:45:27.479247 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: ROLLBACK
[0m18:45:27.489279 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: Close
[0m18:45:27.489279 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:27.489279 [debug] [MainThread]: On master: BEGIN
[0m18:45:27.489279 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:45:27.509306 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m18:45:27.509306 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:27.509306 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:45:27.509306 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m18:45:27.524934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff474e65-1263-40c5-94ce-7d950c62afc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168FAD3730>]}
[0m18:45:27.525158 [debug] [MainThread]: On master: ROLLBACK
[0m18:45:27.525509 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:27.525509 [debug] [MainThread]: On master: BEGIN
[0m18:45:27.525509 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:45:27.526508 [debug] [MainThread]: On master: COMMIT
[0m18:45:27.526508 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:27.526508 [debug] [MainThread]: On master: COMMIT
[0m18:45:27.527509 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:45:27.527509 [debug] [MainThread]: On master: Close
[0m18:45:27.529509 [debug] [Thread-1  ]: Began running node model.mochi_analysis.my_first_dbt_model
[0m18:45:27.529509 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_mochi.my_first_dbt_model ...................... [RUN]
[0m18:45:27.530508 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.mochi_analysis.my_first_dbt_model'
[0m18:45:27.530508 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.my_first_dbt_model
[0m18:45:27.537537 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.my_first_dbt_model"
[0m18:45:27.537537 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.my_first_dbt_model
[0m18:45:27.557379 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.my_first_dbt_model"
[0m18:45:27.557379 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:45:27.557379 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: BEGIN
[0m18:45:27.557379 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:45:27.590476 [debug] [Thread-1  ]: SQL status: BEGIN in 0.024 seconds
[0m18:45:27.590476 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:45:27.591476 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */

  
    

  create  table "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:45:27.594477 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.002 seconds
[0m18:45:27.601227 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:45:27.601227 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:45:27.602226 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:45:27.604226 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:45:27.604226 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:45:27.605227 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:45:27.616229 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: COMMIT
[0m18:45:27.616229 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:45:27.616229 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: COMMIT
[0m18:45:27.617229 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m18:45:27.618243 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_backup"
[0m18:45:27.618243 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:45:27.618243 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
drop table if exists "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_backup" cascade
[0m18:45:27.618243 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m18:45:27.618243 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: Close
[0m18:45:27.618243 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff474e65-1263-40c5-94ce-7d950c62afc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216913A7AF0>]}
[0m18:45:27.618243 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_mochi.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.09s]
[0m18:45:27.618243 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.my_first_dbt_model
[0m18:45:27.618243 [debug] [Thread-1  ]: Began running node model.mochi_analysis.stg_panel_evaluations
[0m18:45:27.618243 [info ] [Thread-1  ]: 2 of 4 START sql view model dbt_mochi.stg_panel_evaluations .................... [RUN]
[0m18:45:27.618243 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.my_first_dbt_model, now model.mochi_analysis.stg_panel_evaluations)
[0m18:45:27.633868 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.stg_panel_evaluations
[0m18:45:27.633868 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.stg_panel_evaluations"
[0m18:45:27.633868 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.stg_panel_evaluations
[0m18:45:27.650087 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.stg_panel_evaluations"
[0m18:45:27.650887 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:45:27.651272 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: BEGIN
[0m18:45:27.651272 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:27.674639 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m18:45:27.674639 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:45:27.674639 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */

  create view "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_tmp"
    
    
  as (
    -- models/Staging/stg_panel_evaluations.sql

select
    "Timestamp" as raw_timestamp,
    -- Formulation 1 (original columns, likely without a suffix)
    "Bitterness" as bitterness_1,
    "Sweetness" as sweetness_1,
    "Chamomile Flavour" as chamomile_flavour_1,
    "Honey Flavour" as honey_flavour_1,         
    "Creaminess" as creaminess_1,               
    "Overall Acceptability" as overall_acceptability_1, 

    -- Formulation 2 (these will be .1 suffix if starting from 0 index, or .2 if first is 1)
    "Bitterness.1" as bitterness_2,           
    "Sweetness.1" as sweetness_2,               
    "Chamomile Flavour.1" as chamomile_flavour_2, 
    "Honey Flavour.1" as honey_flavour_2,
    "Creaminess.1" as creaminess_2,
    "Overall Acceptability.1" as overall_acceptability_2,

    -- Formulation 3 (these will be .2 suffix)
    "Bitterness.2" as bitterness_3,             
    "Sweetness.2" as sweetness_3,
    "Chamomile Flavour.2" as chamomile_flavour_3,
    "Honey Flavour.2" as honey_flavour_3,
    "Creaminess.2" as creaminess_3,
    "Overall Acceptability.2" as overall_acceptability_3,

    -- Formulation 4 (these will be .3 suffix)
    "Bitterness.3" as bitterness_4,
    "Sweetness.3" as sweetness_4,
    "Chamomile Flavour.3" as chamomile_flavour_4,
    "Honey Flavour.3" as honey_flavour_4,
    "Creaminess.3" as creaminess_4,
    "Overall Acceptability.3" as overall_acceptability_4,

    -- Formulation 5 (these will be .4 suffix)
    "Bitterness.4" as bitterness_5,
    "Sweetness.4" as sweetness_5,
    "Chamomile Flavour.4" as chamomile_flavour_5,
    "Honey Flavour.4" as honey_flavour_5,
    "Creaminess.4" as creaminess_5,
    "Overall Acceptability.4" as overall_acceptability_5

from "mochi_data"."public"."raw_panel_evaluations"
  );
[0m18:45:27.674639 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m18:45:27.674639 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:45:27.674639 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
alter table "mochi_data"."dbt_mochi"."stg_panel_evaluations" rename to "stg_panel_evaluations__dbt_backup"
[0m18:45:27.684470 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:45:27.685505 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:45:27.685505 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
alter table "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_tmp" rename to "stg_panel_evaluations"
[0m18:45:27.685505 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:45:27.685505 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: COMMIT
[0m18:45:27.685505 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:45:27.685505 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: COMMIT
[0m18:45:27.685505 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m18:45:27.685505 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_backup"
[0m18:45:27.685505 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:45:27.685505 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
drop view if exists "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_backup" cascade
[0m18:45:27.685505 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m18:45:27.685505 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: Close
[0m18:45:27.685505 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff474e65-1263-40c5-94ce-7d950c62afc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168EBBD9A0>]}
[0m18:45:27.685505 [info ] [Thread-1  ]: 2 of 4 OK created sql view model dbt_mochi.stg_panel_evaluations ............... [[32mCREATE VIEW[0m in 0.07s]
[0m18:45:27.685505 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.stg_panel_evaluations
[0m18:45:27.685505 [debug] [Thread-1  ]: Began running node model.mochi_analysis.my_second_dbt_model
[0m18:45:27.685505 [info ] [Thread-1  ]: 3 of 4 START sql view model dbt_mochi.my_second_dbt_model ...................... [RUN]
[0m18:45:27.685505 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.stg_panel_evaluations, now model.mochi_analysis.my_second_dbt_model)
[0m18:45:27.685505 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.my_second_dbt_model
[0m18:45:27.701126 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.my_second_dbt_model"
[0m18:45:27.701878 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.my_second_dbt_model
[0m18:45:27.701878 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.my_second_dbt_model"
[0m18:45:27.701878 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:45:27.701878 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: BEGIN
[0m18:45:27.701878 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:27.723530 [debug] [Thread-1  ]: SQL status: BEGIN in 0.024 seconds
[0m18:45:27.723530 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:45:27.723530 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */

  create view "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "mochi_data"."dbt_mochi"."my_first_dbt_model"
where id = 1
  );
[0m18:45:27.736219 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:45:27.738221 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:45:27.738221 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:45:27.739221 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:45:27.740231 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: COMMIT
[0m18:45:27.740231 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:45:27.740231 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: COMMIT
[0m18:45:27.740231 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m18:45:27.740231 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_backup"
[0m18:45:27.740231 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:45:27.740231 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */
drop view if exists "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_backup" cascade
[0m18:45:27.740231 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m18:45:27.740231 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: Close
[0m18:45:27.740231 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff474e65-1263-40c5-94ce-7d950c62afc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021691485E20>]}
[0m18:45:27.740231 [info ] [Thread-1  ]: 3 of 4 OK created sql view model dbt_mochi.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.05s]
[0m18:45:27.740231 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.my_second_dbt_model
[0m18:45:27.740231 [debug] [Thread-1  ]: Began running node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m18:45:27.740231 [info ] [Thread-1  ]: 4 of 4 START sql view model dbt_mochi.fct_panel_evaluations_unpivoted .......... [RUN]
[0m18:45:27.740231 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.my_second_dbt_model, now model.mochi_analysis.fct_panel_evaluations_unpivoted)
[0m18:45:27.740231 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m18:45:27.752603 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m18:45:27.752603 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m18:45:27.755602 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m18:45:27.756602 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m18:45:27.756602 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: BEGIN
[0m18:45:27.756602 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:27.884436 [debug] [Thread-1  ]: SQL status: BEGIN in 0.128 seconds
[0m18:45:27.884436 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m18:45:27.884436 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.fct_panel_evaluations_unpivoted"} */

  create view "mochi_data"."dbt_mochi"."fct_panel_evaluations_unpivoted__dbt_tmp"
    
    
  as (
    -- models/fct_panel_evaluations_unpivoted.sql

SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    'Formulation 1' AS flavour_name,
    bitterness_1 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_1, STRPOS(sweetness_1, '(') + 1, STRPOS(sweetness_1, ')') - STRPOS(sweetness_1, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_1, STRPOS(chamomile_flavour_1, '(') + 1, STRPOS(chamomile_flavour_1, ')') - STRPOS(chamomile_flavour_1, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_1, STRPOS(honey_flavour_1, '(') + 1, STRPOS(honey_flavour_1, ')') - STRPOS(honey_flavour_1, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_1, STRPOS(creaminess_1, '(') + 1, STRPOS(creaminess_1, ')') - STRPOS(creaminess_1, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_1 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    'Formulation 2' AS flavour_name,
    bitterness_2 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_2, STRPOS(sweetness_2, '(') + 1, STRPOS(sweetness_2, ')') - STRPOS(sweetness_2, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_2, STRPOS(chamomile_flavour_2, '(') + 1, STRPOS(chamomile_flavour_2, ')') - STRPOS(chamomile_flavour_2, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_2, STRPOS(honey_flavour_2, '(') + 1, STRPOS(honey_flavour_2, ')') - STRPOS(honey_flavour_2, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_2, STRPOS(creaminess_2, '(') + 1, STRPOS(creaminess_2, ')') - STRPOS(creaminess_2, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_2 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

-- Repeat for Flavor 3
SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    'Formulation 3' AS flavour_name,
    bitterness_3 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_3, STRPOS(sweetness_3, '(') + 1, STRPOS(sweetness_3, ')') - STRPOS(sweetness_3, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_3, STRPOS(chamomile_flavour_3, '(') + 1, STRPOS(chamomile_flavour_3, ')') - STRPOS(chamomile_flavour_3, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_3, STRPOS(honey_flavour_3, '(') + 1, STRPOS(honey_flavour_3, ')') - STRPOS(honey_flavour_3, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_3, STRPOS(creaminess_3, '(') + 1, STRPOS(creaminess_3, ')') - STRPOS(creaminess_3, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_3 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

-- Repeat for Flavor 4
SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    'Formulation 4' AS flavour_name,
    bitterness_4 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_4, STRPOS(sweetness_4, '(') + 1, STRPOS(sweetness_4, ')') - STRPOS(sweetness_4, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_4, STRPOS(chamomile_flavour_4, '(') + 1, STRPOS(chamomile_flavour_4, ')') - STRPOS(chamomile_flavour_4, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_4, STRPOS(honey_flavour_4, '(') + 1, STRPOS(honey_flavour_4, ')') - STRPOS(honey_flavour_4, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_4, STRPOS(creaminess_4, '(') + 1, STRPOS(creaminess_4, ')') - STRPOS(creaminess_4, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_4 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

-- Repeat for Flavor 5
SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    'Formulation 5' AS flavour_name,
    bitterness_5 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_5, STRPOS(sweetness_5, '(') + 1, STRPOS(sweetness_5, ')') - STRPOS(sweetness_5, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_5, STRPOS(chamomile_flavour_5, '(') + 1, STRPOS(chamomile_flavour_5, ')') - STRPOS(chamomile_flavour_5, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_5, STRPOS(honey_flavour_5, '(') + 1, STRPOS(honey_flavour_5, ')') - STRPOS(honey_flavour_5, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_5, STRPOS(creaminess_5, '(') + 1, STRPOS(creaminess_5, ')') - STRPOS(creaminess_5, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_5 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1
  );
[0m18:45:27.884436 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m18:45:27.884436 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m18:45:27.884436 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.fct_panel_evaluations_unpivoted"} */
alter table "mochi_data"."dbt_mochi"."fct_panel_evaluations_unpivoted__dbt_tmp" rename to "fct_panel_evaluations_unpivoted"
[0m18:45:27.884436 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:45:27.884436 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: COMMIT
[0m18:45:27.884436 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m18:45:27.884436 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: COMMIT
[0m18:45:27.884436 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m18:45:27.900061 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."fct_panel_evaluations_unpivoted__dbt_backup"
[0m18:45:27.900061 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m18:45:27.900061 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.fct_panel_evaluations_unpivoted"} */
drop view if exists "mochi_data"."dbt_mochi"."fct_panel_evaluations_unpivoted__dbt_backup" cascade
[0m18:45:27.900061 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m18:45:27.900061 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: Close
[0m18:45:27.900061 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff474e65-1263-40c5-94ce-7d950c62afc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216914854C0>]}
[0m18:45:27.900061 [info ] [Thread-1  ]: 4 of 4 OK created sql view model dbt_mochi.fct_panel_evaluations_unpivoted ..... [[32mCREATE VIEW[0m in 0.16s]
[0m18:45:27.900061 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m18:45:27.900061 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:27.900061 [debug] [MainThread]: On master: BEGIN
[0m18:45:27.900061 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:45:27.922325 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m18:45:27.922325 [debug] [MainThread]: On master: COMMIT
[0m18:45:27.922325 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:27.922325 [debug] [MainThread]: On master: COMMIT
[0m18:45:27.922325 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:45:27.922325 [debug] [MainThread]: On master: Close
[0m18:45:27.922325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:27.922325 [debug] [MainThread]: Connection 'list_mochi_data' was properly closed.
[0m18:45:27.922325 [debug] [MainThread]: Connection 'list_mochi_data_dbt_mochi' was properly closed.
[0m18:45:27.922325 [debug] [MainThread]: Connection 'model.mochi_analysis.fct_panel_evaluations_unpivoted' was properly closed.
[0m18:45:27.922325 [info ] [MainThread]: 
[0m18:45:27.922325 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m18:45:27.922325 [debug] [MainThread]: Command end result
[0m18:45:27.949570 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\manifest.json
[0m18:45:27.951571 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\semantic_manifest.json
[0m18:45:27.956557 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\run_results.json
[0m18:45:27.957568 [info ] [MainThread]: 
[0m18:45:27.957568 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:45:27.957568 [info ] [MainThread]: 
[0m18:45:27.957568 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:45:27.957568 [debug] [MainThread]: Command `dbt run` succeeded at 18:45:27.957568 after 1.70 seconds
[0m18:45:27.957568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168D8832B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168FFCDD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168FFC2250>]}
[0m18:45:27.957568 [debug] [MainThread]: Flushing usage events
[0m18:45:28.901058 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:48:35.346767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9891C32B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98A275730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98A275580>]}


============================== 18:48:35.362396 | 0f39c962-817c-4642-a468-6d0cd5564c0d ==============================
[0m18:48:35.362396 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:48:35.362396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\amiru\\Documents\\mochi_dbt\\mochi_analysis\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\amiru\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:48:35.509903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f39c962-817c-4642-a468-6d0cd5564c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F986F70190>]}
[0m18:48:35.541163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f39c962-817c-4642-a468-6d0cd5564c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9870A2910>]}
[0m18:48:35.541163 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:48:35.800978 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:48:35.972875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:48:35.972875 [debug] [MainThread]: Partial parsing: updated file: mochi_analysis://models\fct_panel_evaluations_unpivoted.sql
[0m18:48:36.169681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f39c962-817c-4642-a468-6d0cd5564c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98AA0EE50>]}
[0m18:48:36.256926 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\manifest.json
[0m18:48:36.256926 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\semantic_manifest.json
[0m18:48:36.303634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f39c962-817c-4642-a468-6d0cd5564c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98A8B9F10>]}
[0m18:48:36.303634 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 433 macros
[0m18:48:36.303634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f39c962-817c-4642-a468-6d0cd5564c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98A8B9FA0>]}
[0m18:48:36.303634 [info ] [MainThread]: 
[0m18:48:36.319260 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:48:36.319260 [info ] [MainThread]: 
[0m18:48:36.319260 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:48:36.319260 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mochi_data'
[0m18:48:36.393318 [debug] [ThreadPool]: Using postgres connection "list_mochi_data"
[0m18:48:36.393318 [debug] [ThreadPool]: On list_mochi_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "list_mochi_data"} */

    select distinct nspname from pg_namespace
  
[0m18:48:36.394317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:36.423083 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.029 seconds
[0m18:48:36.424083 [debug] [ThreadPool]: On list_mochi_data: Close
[0m18:48:36.425083 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mochi_data_dbt_mochi'
[0m18:48:36.427099 [debug] [ThreadPool]: Using postgres connection "list_mochi_data_dbt_mochi"
[0m18:48:36.427099 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: BEGIN
[0m18:48:36.427099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:36.442725 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m18:48:36.442725 [debug] [ThreadPool]: Using postgres connection "list_mochi_data_dbt_mochi"
[0m18:48:36.442725 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "list_mochi_data_dbt_mochi"} */
select
      'mochi_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_mochi'
    union all
    select
      'mochi_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_mochi'
    union all
    select
      'mochi_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_mochi'
  
[0m18:48:36.458352 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m18:48:36.458352 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: ROLLBACK
[0m18:48:36.458352 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: Close
[0m18:48:36.458352 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:36.458352 [debug] [MainThread]: On master: BEGIN
[0m18:48:36.458352 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:48:36.491031 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m18:48:36.491031 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:36.492031 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:48:36.497264 [debug] [MainThread]: SQL status: SELECT 3 in 0.005 seconds
[0m18:48:36.498264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f39c962-817c-4642-a468-6d0cd5564c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98A4429D0>]}
[0m18:48:36.499264 [debug] [MainThread]: On master: ROLLBACK
[0m18:48:36.499264 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:36.499264 [debug] [MainThread]: On master: BEGIN
[0m18:48:36.500264 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:48:36.500264 [debug] [MainThread]: On master: COMMIT
[0m18:48:36.500264 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:36.501264 [debug] [MainThread]: On master: COMMIT
[0m18:48:36.501264 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:48:36.501264 [debug] [MainThread]: On master: Close
[0m18:48:36.504266 [debug] [Thread-1  ]: Began running node model.mochi_analysis.my_first_dbt_model
[0m18:48:36.504266 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_mochi.my_first_dbt_model ...................... [RUN]
[0m18:48:36.505266 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.mochi_analysis.my_first_dbt_model'
[0m18:48:36.505266 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.my_first_dbt_model
[0m18:48:36.509886 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.my_first_dbt_model"
[0m18:48:36.509886 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.my_first_dbt_model
[0m18:48:36.536360 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.my_first_dbt_model"
[0m18:48:36.536360 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:48:36.536360 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: BEGIN
[0m18:48:36.536360 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:48:36.671487 [debug] [Thread-1  ]: SQL status: BEGIN in 0.134 seconds
[0m18:48:36.671487 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:48:36.671487 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */

  
    

  create  table "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:48:36.671487 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.003 seconds
[0m18:48:36.686953 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:48:36.686953 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:48:36.686953 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:48:36.686953 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:48:36.686953 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:48:36.686953 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:48:36.686953 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: COMMIT
[0m18:48:36.686953 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:48:36.702752 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: COMMIT
[0m18:48:36.702752 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m18:48:36.702752 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_backup"
[0m18:48:36.702752 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m18:48:36.702752 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
drop table if exists "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_backup" cascade
[0m18:48:36.702752 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m18:48:36.702752 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: Close
[0m18:48:36.702752 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f39c962-817c-4642-a468-6d0cd5564c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98BD1BB80>]}
[0m18:48:36.702752 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_mochi.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.20s]
[0m18:48:36.718204 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.my_first_dbt_model
[0m18:48:36.718204 [debug] [Thread-1  ]: Began running node model.mochi_analysis.stg_panel_evaluations
[0m18:48:36.718204 [info ] [Thread-1  ]: 2 of 4 START sql view model dbt_mochi.stg_panel_evaluations .................... [RUN]
[0m18:48:36.718204 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.my_first_dbt_model, now model.mochi_analysis.stg_panel_evaluations)
[0m18:48:36.718204 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.stg_panel_evaluations
[0m18:48:36.718204 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.stg_panel_evaluations"
[0m18:48:36.718204 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.stg_panel_evaluations
[0m18:48:36.738826 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.stg_panel_evaluations"
[0m18:48:36.739825 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:48:36.739825 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: BEGIN
[0m18:48:36.739825 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:48:36.761250 [debug] [Thread-1  ]: SQL status: BEGIN in 0.027 seconds
[0m18:48:36.761250 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:48:36.761250 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */

  create view "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_tmp"
    
    
  as (
    -- models/Staging/stg_panel_evaluations.sql

select
    "Timestamp" as raw_timestamp,
    -- Formulation 1 (original columns, likely without a suffix)
    "Bitterness" as bitterness_1,
    "Sweetness" as sweetness_1,
    "Chamomile Flavour" as chamomile_flavour_1,
    "Honey Flavour" as honey_flavour_1,         
    "Creaminess" as creaminess_1,               
    "Overall Acceptability" as overall_acceptability_1, 

    -- Formulation 2 (these will be .1 suffix if starting from 0 index, or .2 if first is 1)
    "Bitterness.1" as bitterness_2,           
    "Sweetness.1" as sweetness_2,               
    "Chamomile Flavour.1" as chamomile_flavour_2, 
    "Honey Flavour.1" as honey_flavour_2,
    "Creaminess.1" as creaminess_2,
    "Overall Acceptability.1" as overall_acceptability_2,

    -- Formulation 3 (these will be .2 suffix)
    "Bitterness.2" as bitterness_3,             
    "Sweetness.2" as sweetness_3,
    "Chamomile Flavour.2" as chamomile_flavour_3,
    "Honey Flavour.2" as honey_flavour_3,
    "Creaminess.2" as creaminess_3,
    "Overall Acceptability.2" as overall_acceptability_3,

    -- Formulation 4 (these will be .3 suffix)
    "Bitterness.3" as bitterness_4,
    "Sweetness.3" as sweetness_4,
    "Chamomile Flavour.3" as chamomile_flavour_4,
    "Honey Flavour.3" as honey_flavour_4,
    "Creaminess.3" as creaminess_4,
    "Overall Acceptability.3" as overall_acceptability_4,

    -- Formulation 5 (these will be .4 suffix)
    "Bitterness.4" as bitterness_5,
    "Sweetness.4" as sweetness_5,
    "Chamomile Flavour.4" as chamomile_flavour_5,
    "Honey Flavour.4" as honey_flavour_5,
    "Creaminess.4" as creaminess_5,
    "Overall Acceptability.4" as overall_acceptability_5

from "mochi_data"."public"."raw_panel_evaluations"
  );
[0m18:48:36.761250 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m18:48:36.761250 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:48:36.761250 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
alter table "mochi_data"."dbt_mochi"."stg_panel_evaluations" rename to "stg_panel_evaluations__dbt_backup"
[0m18:48:36.761250 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:48:36.777155 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:48:36.777155 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
alter table "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_tmp" rename to "stg_panel_evaluations"
[0m18:48:36.777155 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:48:36.777155 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: COMMIT
[0m18:48:36.777155 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:48:36.777155 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: COMMIT
[0m18:48:36.777155 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m18:48:36.777155 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_backup"
[0m18:48:36.777155 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m18:48:36.777155 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
drop view if exists "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_backup" cascade
[0m18:48:36.793645 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.007 seconds
[0m18:48:36.794646 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: Close
[0m18:48:36.794646 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f39c962-817c-4642-a468-6d0cd5564c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98952C9A0>]}
[0m18:48:36.795647 [info ] [Thread-1  ]: 2 of 4 OK created sql view model dbt_mochi.stg_panel_evaluations ............... [[32mCREATE VIEW[0m in 0.08s]
[0m18:48:36.795647 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.stg_panel_evaluations
[0m18:48:36.796646 [debug] [Thread-1  ]: Began running node model.mochi_analysis.my_second_dbt_model
[0m18:48:36.796646 [info ] [Thread-1  ]: 3 of 4 START sql view model dbt_mochi.my_second_dbt_model ...................... [RUN]
[0m18:48:36.797648 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.stg_panel_evaluations, now model.mochi_analysis.my_second_dbt_model)
[0m18:48:36.797648 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.my_second_dbt_model
[0m18:48:36.799648 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.my_second_dbt_model"
[0m18:48:36.800648 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.my_second_dbt_model
[0m18:48:36.803648 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.my_second_dbt_model"
[0m18:48:36.804649 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:48:36.804649 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: BEGIN
[0m18:48:36.804649 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:48:36.830643 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m18:48:36.830643 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:48:36.831642 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */

  create view "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "mochi_data"."dbt_mochi"."my_first_dbt_model"
where id = 1
  );
[0m18:48:36.833654 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:48:36.833654 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:48:36.833654 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:48:36.833654 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:48:36.833654 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: COMMIT
[0m18:48:36.833654 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:48:36.833654 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: COMMIT
[0m18:48:36.833654 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m18:48:36.841189 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_backup"
[0m18:48:36.843281 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m18:48:36.843281 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */
drop view if exists "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_backup" cascade
[0m18:48:36.843281 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m18:48:36.844280 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: Close
[0m18:48:36.845280 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f39c962-817c-4642-a468-6d0cd5564c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98952C9A0>]}
[0m18:48:36.845280 [info ] [Thread-1  ]: 3 of 4 OK created sql view model dbt_mochi.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.05s]
[0m18:48:36.846787 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.my_second_dbt_model
[0m18:48:36.846787 [debug] [Thread-1  ]: Began running node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m18:48:36.846787 [info ] [Thread-1  ]: 4 of 4 START sql view model dbt_mochi.fct_panel_evaluations_unpivoted .......... [RUN]
[0m18:48:36.846787 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.my_second_dbt_model, now model.mochi_analysis.fct_panel_evaluations_unpivoted)
[0m18:48:36.846787 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m18:48:36.851291 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m18:48:36.851291 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m18:48:36.851291 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m18:48:36.851291 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m18:48:36.851291 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: BEGIN
[0m18:48:36.851291 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:48:36.885794 [debug] [Thread-1  ]: SQL status: BEGIN in 0.030 seconds
[0m18:48:36.885794 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m18:48:36.885794 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.fct_panel_evaluations_unpivoted"} */

  create view "mochi_data"."dbt_mochi"."fct_panel_evaluations_unpivoted__dbt_tmp"
    
    
  as (
    -- models/fct_panel_evaluations_unpivoted.sql

SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '1' AS Formulation,
    bitterness_1 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_1, STRPOS(sweetness_1, '(') + 1, STRPOS(sweetness_1, ')') - STRPOS(sweetness_1, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_1, STRPOS(chamomile_flavour_1, '(') + 1, STRPOS(chamomile_flavour_1, ')') - STRPOS(chamomile_flavour_1, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_1, STRPOS(honey_flavour_1, '(') + 1, STRPOS(honey_flavour_1, ')') - STRPOS(honey_flavour_1, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_1, STRPOS(creaminess_1, '(') + 1, STRPOS(creaminess_1, ')') - STRPOS(creaminess_1, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_1 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '2' AS Formulation,
    bitterness_2 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_2, STRPOS(sweetness_2, '(') + 1, STRPOS(sweetness_2, ')') - STRPOS(sweetness_2, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_2, STRPOS(chamomile_flavour_2, '(') + 1, STRPOS(chamomile_flavour_2, ')') - STRPOS(chamomile_flavour_2, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_2, STRPOS(honey_flavour_2, '(') + 1, STRPOS(honey_flavour_2, ')') - STRPOS(honey_flavour_2, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_2, STRPOS(creaminess_2, '(') + 1, STRPOS(creaminess_2, ')') - STRPOS(creaminess_2, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_2 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

-- Repeat for Flavor 3
SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '3' AS Formulation
    bitterness_3 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_3, STRPOS(sweetness_3, '(') + 1, STRPOS(sweetness_3, ')') - STRPOS(sweetness_3, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_3, STRPOS(chamomile_flavour_3, '(') + 1, STRPOS(chamomile_flavour_3, ')') - STRPOS(chamomile_flavour_3, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_3, STRPOS(honey_flavour_3, '(') + 1, STRPOS(honey_flavour_3, ')') - STRPOS(honey_flavour_3, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_3, STRPOS(creaminess_3, '(') + 1, STRPOS(creaminess_3, ')') - STRPOS(creaminess_3, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_3 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

-- Repeat for Flavor 4
SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '4' AS Formulation,
    bitterness_4 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_4, STRPOS(sweetness_4, '(') + 1, STRPOS(sweetness_4, ')') - STRPOS(sweetness_4, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_4, STRPOS(chamomile_flavour_4, '(') + 1, STRPOS(chamomile_flavour_4, ')') - STRPOS(chamomile_flavour_4, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_4, STRPOS(honey_flavour_4, '(') + 1, STRPOS(honey_flavour_4, ')') - STRPOS(honey_flavour_4, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_4, STRPOS(creaminess_4, '(') + 1, STRPOS(creaminess_4, ')') - STRPOS(creaminess_4, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_4 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

-- Repeat for Flavor 5
SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '5' AS Formulation,
    bitterness_5 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_5, STRPOS(sweetness_5, '(') + 1, STRPOS(sweetness_5, ')') - STRPOS(sweetness_5, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_5, STRPOS(chamomile_flavour_5, '(') + 1, STRPOS(chamomile_flavour_5, ')') - STRPOS(chamomile_flavour_5, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_5, STRPOS(honey_flavour_5, '(') + 1, STRPOS(honey_flavour_5, ')') - STRPOS(honey_flavour_5, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_5, STRPOS(creaminess_5, '(') + 1, STRPOS(creaminess_5, ')') - STRPOS(creaminess_5, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_5 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1
  );
[0m18:48:36.885794 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "bitterness_3"
LINE 45:     bitterness_3 AS bitterness_score,
             ^

[0m18:48:36.885794 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: ROLLBACK
[0m18:48:36.885794 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: Close
[0m18:48:36.893237 [debug] [Thread-1  ]: Database Error in model fct_panel_evaluations_unpivoted (models\fct_panel_evaluations_unpivoted.sql)
  syntax error at or near "bitterness_3"
  LINE 45:     bitterness_3 AS bitterness_score,
               ^
  compiled code at target\run\mochi_analysis\models\fct_panel_evaluations_unpivoted.sql
[0m18:48:36.894236 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f39c962-817c-4642-a468-6d0cd5564c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98952C9A0>]}
[0m18:48:36.895024 [error] [Thread-1  ]: 4 of 4 ERROR creating sql view model dbt_mochi.fct_panel_evaluations_unpivoted . [[31mERROR[0m in 0.05s]
[0m18:48:36.895024 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m18:48:36.895024 [debug] [Thread-4  ]: Marking all children of 'model.mochi_analysis.fct_panel_evaluations_unpivoted' to be skipped because of status 'error'.  Reason: Database Error in model fct_panel_evaluations_unpivoted (models\fct_panel_evaluations_unpivoted.sql)
  syntax error at or near "bitterness_3"
  LINE 45:     bitterness_3 AS bitterness_score,
               ^
  compiled code at target\run\mochi_analysis\models\fct_panel_evaluations_unpivoted.sql.
[0m18:48:36.895024 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:36.895024 [debug] [MainThread]: On master: BEGIN
[0m18:48:36.895024 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:48:36.917265 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m18:48:36.917265 [debug] [MainThread]: On master: COMMIT
[0m18:48:36.917265 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:36.917265 [debug] [MainThread]: On master: COMMIT
[0m18:48:36.917265 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:48:36.917265 [debug] [MainThread]: On master: Close
[0m18:48:36.917265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:48:36.917265 [debug] [MainThread]: Connection 'list_mochi_data' was properly closed.
[0m18:48:36.926535 [debug] [MainThread]: Connection 'list_mochi_data_dbt_mochi' was properly closed.
[0m18:48:36.926535 [debug] [MainThread]: Connection 'model.mochi_analysis.fct_panel_evaluations_unpivoted' was properly closed.
[0m18:48:36.926535 [info ] [MainThread]: 
[0m18:48:36.927534 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m18:48:36.928386 [debug] [MainThread]: Command end result
[0m18:48:36.944317 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\manifest.json
[0m18:48:36.946316 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\semantic_manifest.json
[0m18:48:36.950330 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\run_results.json
[0m18:48:36.950330 [info ] [MainThread]: 
[0m18:48:36.950330 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:48:36.953307 [info ] [MainThread]: 
[0m18:48:36.953307 [error] [MainThread]:   Database Error in model fct_panel_evaluations_unpivoted (models\fct_panel_evaluations_unpivoted.sql)
  syntax error at or near "bitterness_3"
  LINE 45:     bitterness_3 AS bitterness_score,
               ^
  compiled code at target\run\mochi_analysis\models\fct_panel_evaluations_unpivoted.sql
[0m18:48:36.954306 [info ] [MainThread]: 
[0m18:48:36.954306 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:48:36.955306 [debug] [MainThread]: Command `dbt run` failed at 18:48:36.955306 after 1.65 seconds
[0m18:48:36.955306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9891C32B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98A932A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98A9328E0>]}
[0m18:48:36.956306 [debug] [MainThread]: Flushing usage events
[0m18:48:37.943608 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:29:29.076003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD1B53280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD3BC6700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD3BC6550>]}


============================== 19:29:29.080004 | ee37a407-c2d6-4613-8ce4-b0c5a21759a7 ==============================
[0m19:29:29.080004 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:29:29.080004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\amiru\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\amiru\\Documents\\mochi_dbt\\mochi_analysis\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:29:29.295262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee37a407-c2d6-4613-8ce4-b0c5a21759a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD3BAD0D0>]}
[0m19:29:29.334135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee37a407-c2d6-4613-8ce4-b0c5a21759a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD3B9B5B0>]}
[0m19:29:29.334135 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:29:29.601835 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:29:30.026823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:29:30.026823 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:29:30.069514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee37a407-c2d6-4613-8ce4-b0c5a21759a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD41A7F40>]}
[0m19:29:30.147642 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\manifest.json
[0m19:29:30.163269 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\semantic_manifest.json
[0m19:29:30.178895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee37a407-c2d6-4613-8ce4-b0c5a21759a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD41C5E50>]}
[0m19:29:30.178895 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 433 macros
[0m19:29:30.178895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee37a407-c2d6-4613-8ce4-b0c5a21759a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD417EF70>]}
[0m19:29:30.178895 [info ] [MainThread]: 
[0m19:29:30.178895 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:29:30.178895 [info ] [MainThread]: 
[0m19:29:30.178895 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:29:30.194521 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mochi_data'
[0m19:29:30.366488 [debug] [ThreadPool]: Using postgres connection "list_mochi_data"
[0m19:29:30.366488 [debug] [ThreadPool]: On list_mochi_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "list_mochi_data"} */

    select distinct nspname from pg_namespace
  
[0m19:29:30.366488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:30.402841 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.040 seconds
[0m19:29:30.402841 [debug] [ThreadPool]: On list_mochi_data: Close
[0m19:29:30.402841 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mochi_data_dbt_mochi'
[0m19:29:30.418467 [debug] [ThreadPool]: Using postgres connection "list_mochi_data_dbt_mochi"
[0m19:29:30.418467 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: BEGIN
[0m19:29:30.418467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:30.434091 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m19:29:30.434091 [debug] [ThreadPool]: Using postgres connection "list_mochi_data_dbt_mochi"
[0m19:29:30.434091 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "list_mochi_data_dbt_mochi"} */
select
      'mochi_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_mochi'
    union all
    select
      'mochi_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_mochi'
    union all
    select
      'mochi_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_mochi'
  
[0m19:29:30.449718 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m19:29:30.449718 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: ROLLBACK
[0m19:29:30.449718 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: Close
[0m19:29:30.480971 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:30.480971 [debug] [MainThread]: On master: BEGIN
[0m19:29:30.480971 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:29:30.496596 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m19:29:30.496596 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:30.496596 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:29:30.512222 [debug] [MainThread]: SQL status: SELECT 2 in 0.008 seconds
[0m19:29:30.512222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee37a407-c2d6-4613-8ce4-b0c5a21759a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD2ECC220>]}
[0m19:29:30.512222 [debug] [MainThread]: On master: ROLLBACK
[0m19:29:30.512222 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:30.512222 [debug] [MainThread]: On master: BEGIN
[0m19:29:30.512222 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:29:30.512222 [debug] [MainThread]: On master: COMMIT
[0m19:29:30.512222 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:30.512222 [debug] [MainThread]: On master: COMMIT
[0m19:29:30.512222 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:29:30.512222 [debug] [MainThread]: On master: Close
[0m19:29:30.512222 [debug] [Thread-1  ]: Began running node model.mochi_analysis.my_first_dbt_model
[0m19:29:30.512222 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_mochi.my_first_dbt_model ...................... [RUN]
[0m19:29:30.512222 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.mochi_analysis.my_first_dbt_model'
[0m19:29:30.512222 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.my_first_dbt_model
[0m19:29:30.527849 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.my_first_dbt_model"
[0m19:29:30.527849 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.my_first_dbt_model
[0m19:29:30.558340 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.my_first_dbt_model"
[0m19:29:30.558340 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:29:30.558340 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: BEGIN
[0m19:29:30.558340 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:29:30.589185 [debug] [Thread-1  ]: SQL status: BEGIN in 0.026 seconds
[0m19:29:30.590185 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:29:30.590185 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */

  
    

  create  table "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:29:30.598187 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.008 seconds
[0m19:29:30.602831 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:29:30.602831 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:29:30.602831 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:29:30.602831 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:29:30.602831 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:29:30.602831 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:29:30.618456 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: COMMIT
[0m19:29:30.618456 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:29:30.618456 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: COMMIT
[0m19:29:30.618456 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m19:29:30.618456 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_backup"
[0m19:29:30.634081 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:29:30.634081 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
drop table if exists "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_backup" cascade
[0m19:29:30.634081 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.010 seconds
[0m19:29:30.634081 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: Close
[0m19:29:30.634081 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee37a407-c2d6-4613-8ce4-b0c5a21759a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD00C6610>]}
[0m19:29:30.649708 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_mochi.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.12s]
[0m19:29:30.649708 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.my_first_dbt_model
[0m19:29:30.649708 [debug] [Thread-1  ]: Began running node model.mochi_analysis.stg_panel_evaluations
[0m19:29:30.649708 [info ] [Thread-1  ]: 2 of 4 START sql view model dbt_mochi.stg_panel_evaluations .................... [RUN]
[0m19:29:30.649708 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.my_first_dbt_model, now model.mochi_analysis.stg_panel_evaluations)
[0m19:29:30.649708 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.stg_panel_evaluations
[0m19:29:30.649708 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.stg_panel_evaluations"
[0m19:29:30.649708 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.stg_panel_evaluations
[0m19:29:30.669105 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.stg_panel_evaluations"
[0m19:29:30.670166 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:29:30.670166 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: BEGIN
[0m19:29:30.670166 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:29:30.692967 [debug] [Thread-1  ]: SQL status: BEGIN in 0.027 seconds
[0m19:29:30.692967 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:29:30.692967 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */

  create view "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_tmp"
    
    
  as (
    -- models/Staging/stg_panel_evaluations.sql

select
    "Timestamp" as raw_timestamp,
    -- Formulation 1 (original columns, likely without a suffix)
    "Bitterness" as bitterness_1,
    "Sweetness" as sweetness_1,
    "Chamomile Flavour" as chamomile_flavour_1,
    "Honey Flavour" as honey_flavour_1,         
    "Creaminess" as creaminess_1,               
    "Overall Acceptability" as overall_acceptability_1, 

    -- Formulation 2 (these will be .1 suffix if starting from 0 index, or .2 if first is 1)
    "Bitterness.1" as bitterness_2,           
    "Sweetness.1" as sweetness_2,               
    "Chamomile Flavour.1" as chamomile_flavour_2, 
    "Honey Flavour.1" as honey_flavour_2,
    "Creaminess.1" as creaminess_2,
    "Overall Acceptability.1" as overall_acceptability_2,

    -- Formulation 3 (these will be .2 suffix)
    "Bitterness.2" as bitterness_3,             
    "Sweetness.2" as sweetness_3,
    "Chamomile Flavour.2" as chamomile_flavour_3,
    "Honey Flavour.2" as honey_flavour_3,
    "Creaminess.2" as creaminess_3,
    "Overall Acceptability.2" as overall_acceptability_3,

    -- Formulation 4 (these will be .3 suffix)
    "Bitterness.3" as bitterness_4,
    "Sweetness.3" as sweetness_4,
    "Chamomile Flavour.3" as chamomile_flavour_4,
    "Honey Flavour.3" as honey_flavour_4,
    "Creaminess.3" as creaminess_4,
    "Overall Acceptability.3" as overall_acceptability_4,

    -- Formulation 5 (these will be .4 suffix)
    "Bitterness.4" as bitterness_5,
    "Sweetness.4" as sweetness_5,
    "Chamomile Flavour.4" as chamomile_flavour_5,
    "Honey Flavour.4" as honey_flavour_5,
    "Creaminess.4" as creaminess_5,
    "Overall Acceptability.4" as overall_acceptability_5

from "mochi_data"."public"."raw_panel_evaluations"
  );
[0m19:29:30.703582 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.007 seconds
[0m19:29:30.703582 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:29:30.703582 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
alter table "mochi_data"."dbt_mochi"."stg_panel_evaluations" rename to "stg_panel_evaluations__dbt_backup"
[0m19:29:30.703582 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:29:30.703582 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:29:30.703582 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
alter table "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_tmp" rename to "stg_panel_evaluations"
[0m19:29:30.703582 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:29:30.703582 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: COMMIT
[0m19:29:30.703582 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:29:30.703582 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: COMMIT
[0m19:29:30.703582 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m19:29:30.703582 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_backup"
[0m19:29:30.720620 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:29:30.720620 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
drop view if exists "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_backup" cascade
[0m19:29:30.721621 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m19:29:30.722621 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: Close
[0m19:29:30.723621 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee37a407-c2d6-4613-8ce4-b0c5a21759a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD4295430>]}
[0m19:29:30.723621 [info ] [Thread-1  ]: 2 of 4 OK created sql view model dbt_mochi.stg_panel_evaluations ............... [[32mCREATE VIEW[0m in 0.07s]
[0m19:29:30.724622 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.stg_panel_evaluations
[0m19:29:30.725622 [debug] [Thread-1  ]: Began running node model.mochi_analysis.my_second_dbt_model
[0m19:29:30.725622 [info ] [Thread-1  ]: 3 of 4 START sql view model dbt_mochi.my_second_dbt_model ...................... [RUN]
[0m19:29:30.726622 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.stg_panel_evaluations, now model.mochi_analysis.my_second_dbt_model)
[0m19:29:30.726622 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.my_second_dbt_model
[0m19:29:30.728622 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.my_second_dbt_model"
[0m19:29:30.729622 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.my_second_dbt_model
[0m19:29:30.732623 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.my_second_dbt_model"
[0m19:29:30.732623 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:29:30.733624 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: BEGIN
[0m19:29:30.733624 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:29:30.758402 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m19:29:30.758402 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:29:30.758402 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */

  create view "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "mochi_data"."dbt_mochi"."my_first_dbt_model"
where id = 1
  );
[0m19:29:30.758402 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:29:30.758402 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:29:30.758402 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:29:30.758402 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:29:30.758402 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: COMMIT
[0m19:29:30.758402 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:29:30.758402 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: COMMIT
[0m19:29:30.758402 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m19:29:30.770032 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_backup"
[0m19:29:30.770032 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:29:30.770032 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */
drop view if exists "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_backup" cascade
[0m19:29:30.770032 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m19:29:30.770032 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: Close
[0m19:29:30.770032 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee37a407-c2d6-4613-8ce4-b0c5a21759a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD4709EE0>]}
[0m19:29:30.770032 [info ] [Thread-1  ]: 3 of 4 OK created sql view model dbt_mochi.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.04s]
[0m19:29:30.770032 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.my_second_dbt_model
[0m19:29:30.770032 [debug] [Thread-1  ]: Began running node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m19:29:30.770032 [info ] [Thread-1  ]: 4 of 4 START sql view model dbt_mochi.fct_panel_evaluations_unpivoted .......... [RUN]
[0m19:29:30.770032 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.my_second_dbt_model, now model.mochi_analysis.fct_panel_evaluations_unpivoted)
[0m19:29:30.770032 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m19:29:30.770032 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m19:29:30.770032 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m19:29:30.770032 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m19:29:30.770032 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m19:29:30.770032 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: BEGIN
[0m19:29:30.770032 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:29:30.808889 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m19:29:30.808889 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m19:29:30.808889 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.fct_panel_evaluations_unpivoted"} */

  create view "mochi_data"."dbt_mochi"."fct_panel_evaluations_unpivoted__dbt_tmp"
    
    
  as (
    -- models/fct_panel_evaluations_unpivoted.sql

SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '1' AS Formulation,
    bitterness_1 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_1, STRPOS(sweetness_1, '(') + 1, STRPOS(sweetness_1, ')') - STRPOS(sweetness_1, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_1, STRPOS(chamomile_flavour_1, '(') + 1, STRPOS(chamomile_flavour_1, ')') - STRPOS(chamomile_flavour_1, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_1, STRPOS(honey_flavour_1, '(') + 1, STRPOS(honey_flavour_1, ')') - STRPOS(honey_flavour_1, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_1, STRPOS(creaminess_1, '(') + 1, STRPOS(creaminess_1, ')') - STRPOS(creaminess_1, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_1 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '2' AS Formulation,
    bitterness_2 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_2, STRPOS(sweetness_2, '(') + 1, STRPOS(sweetness_2, ')') - STRPOS(sweetness_2, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_2, STRPOS(chamomile_flavour_2, '(') + 1, STRPOS(chamomile_flavour_2, ')') - STRPOS(chamomile_flavour_2, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_2, STRPOS(honey_flavour_2, '(') + 1, STRPOS(honey_flavour_2, ')') - STRPOS(honey_flavour_2, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_2, STRPOS(creaminess_2, '(') + 1, STRPOS(creaminess_2, ')') - STRPOS(creaminess_2, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_2 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

-- Repeat for Flavor 3
SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '3' AS Formulation
    bitterness_3 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_3, STRPOS(sweetness_3, '(') + 1, STRPOS(sweetness_3, ')') - STRPOS(sweetness_3, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_3, STRPOS(chamomile_flavour_3, '(') + 1, STRPOS(chamomile_flavour_3, ')') - STRPOS(chamomile_flavour_3, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_3, STRPOS(honey_flavour_3, '(') + 1, STRPOS(honey_flavour_3, ')') - STRPOS(honey_flavour_3, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_3, STRPOS(creaminess_3, '(') + 1, STRPOS(creaminess_3, ')') - STRPOS(creaminess_3, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_3 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

-- Repeat for Flavor 4
SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '4' AS Formulation,
    bitterness_4 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_4, STRPOS(sweetness_4, '(') + 1, STRPOS(sweetness_4, ')') - STRPOS(sweetness_4, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_4, STRPOS(chamomile_flavour_4, '(') + 1, STRPOS(chamomile_flavour_4, ')') - STRPOS(chamomile_flavour_4, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_4, STRPOS(honey_flavour_4, '(') + 1, STRPOS(honey_flavour_4, ')') - STRPOS(honey_flavour_4, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_4, STRPOS(creaminess_4, '(') + 1, STRPOS(creaminess_4, ')') - STRPOS(creaminess_4, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_4 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

-- Repeat for Flavor 5
SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '5' AS Formulation,
    bitterness_5 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_5, STRPOS(sweetness_5, '(') + 1, STRPOS(sweetness_5, ')') - STRPOS(sweetness_5, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_5, STRPOS(chamomile_flavour_5, '(') + 1, STRPOS(chamomile_flavour_5, ')') - STRPOS(chamomile_flavour_5, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_5, STRPOS(honey_flavour_5, '(') + 1, STRPOS(honey_flavour_5, ')') - STRPOS(honey_flavour_5, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_5, STRPOS(creaminess_5, '(') + 1, STRPOS(creaminess_5, ')') - STRPOS(creaminess_5, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_5 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1
  );
[0m19:29:30.808889 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "bitterness_3"
LINE 45:     bitterness_3 AS bitterness_score,
             ^

[0m19:29:30.808889 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: ROLLBACK
[0m19:29:30.808889 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: Close
[0m19:29:30.820434 [debug] [Thread-1  ]: Database Error in model fct_panel_evaluations_unpivoted (models\fct_panel_evaluations_unpivoted.sql)
  syntax error at or near "bitterness_3"
  LINE 45:     bitterness_3 AS bitterness_score,
               ^
  compiled code at target\run\mochi_analysis\models\fct_panel_evaluations_unpivoted.sql
[0m19:29:30.820434 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee37a407-c2d6-4613-8ce4-b0c5a21759a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD4599F40>]}
[0m19:29:30.820434 [error] [Thread-1  ]: 4 of 4 ERROR creating sql view model dbt_mochi.fct_panel_evaluations_unpivoted . [[31mERROR[0m in 0.05s]
[0m19:29:30.820434 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m19:29:30.820434 [debug] [Thread-4  ]: Marking all children of 'model.mochi_analysis.fct_panel_evaluations_unpivoted' to be skipped because of status 'error'.  Reason: Database Error in model fct_panel_evaluations_unpivoted (models\fct_panel_evaluations_unpivoted.sql)
  syntax error at or near "bitterness_3"
  LINE 45:     bitterness_3 AS bitterness_score,
               ^
  compiled code at target\run\mochi_analysis\models\fct_panel_evaluations_unpivoted.sql.
[0m19:29:30.820434 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:30.820434 [debug] [MainThread]: On master: BEGIN
[0m19:29:30.820434 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:29:30.843281 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m19:29:30.843281 [debug] [MainThread]: On master: COMMIT
[0m19:29:30.843281 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:30.843281 [debug] [MainThread]: On master: COMMIT
[0m19:29:30.843281 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:29:30.843281 [debug] [MainThread]: On master: Close
[0m19:29:30.852844 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:29:30.852844 [debug] [MainThread]: Connection 'list_mochi_data' was properly closed.
[0m19:29:30.852844 [debug] [MainThread]: Connection 'list_mochi_data_dbt_mochi' was properly closed.
[0m19:29:30.852844 [debug] [MainThread]: Connection 'model.mochi_analysis.fct_panel_evaluations_unpivoted' was properly closed.
[0m19:29:30.853965 [info ] [MainThread]: 
[0m19:29:30.853965 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m19:29:30.853965 [debug] [MainThread]: Command end result
[0m19:29:30.871572 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\manifest.json
[0m19:29:30.873573 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\semantic_manifest.json
[0m19:29:30.875586 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\run_results.json
[0m19:29:30.875586 [info ] [MainThread]: 
[0m19:29:30.875586 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:29:30.875586 [info ] [MainThread]: 
[0m19:29:30.880763 [error] [MainThread]:   Database Error in model fct_panel_evaluations_unpivoted (models\fct_panel_evaluations_unpivoted.sql)
  syntax error at or near "bitterness_3"
  LINE 45:     bitterness_3 AS bitterness_score,
               ^
  compiled code at target\run\mochi_analysis\models\fct_panel_evaluations_unpivoted.sql
[0m19:29:30.880763 [info ] [MainThread]: 
[0m19:29:30.881761 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:29:30.881761 [debug] [MainThread]: Command `dbt run` failed at 19:29:30.881761 after 1.87 seconds
[0m19:29:30.882761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD1B53280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD3D2AAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD3D2A4C0>]}
[0m19:29:30.882761 [debug] [MainThread]: Flushing usage events
[0m19:29:31.969914 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:29:48.687741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A14F832B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A16045730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A16045580>]}


============================== 19:29:48.702093 | 5822d221-d6e0-4bfa-94c4-2850027d5b12 ==============================
[0m19:29:48.702093 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:29:48.702828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\amiru\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\amiru\\Documents\\mochi_dbt\\mochi_analysis\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:29:48.852074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5822d221-d6e0-4bfa-94c4-2850027d5b12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A12D30190>]}
[0m19:29:48.886974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5822d221-d6e0-4bfa-94c4-2850027d5b12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A12E62910>]}
[0m19:29:48.886974 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:29:49.164083 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:29:49.376891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:29:49.376891 [debug] [MainThread]: Partial parsing: updated file: mochi_analysis://models\fct_panel_evaluations_unpivoted.sql
[0m19:29:49.568836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5822d221-d6e0-4bfa-94c4-2850027d5b12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A167DFE50>]}
[0m19:29:49.649069 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\manifest.json
[0m19:29:49.649069 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\semantic_manifest.json
[0m19:29:49.695948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5822d221-d6e0-4bfa-94c4-2850027d5b12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A16689F10>]}
[0m19:29:49.695948 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 433 macros
[0m19:29:49.695948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5822d221-d6e0-4bfa-94c4-2850027d5b12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A16689FA0>]}
[0m19:29:49.695948 [info ] [MainThread]: 
[0m19:29:49.695948 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:29:49.695948 [info ] [MainThread]: 
[0m19:29:49.695948 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:29:49.695948 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mochi_data'
[0m19:29:49.771877 [debug] [ThreadPool]: Using postgres connection "list_mochi_data"
[0m19:29:49.771877 [debug] [ThreadPool]: On list_mochi_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "list_mochi_data"} */

    select distinct nspname from pg_namespace
  
[0m19:29:49.771877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:49.916287 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.140 seconds
[0m19:29:49.916287 [debug] [ThreadPool]: On list_mochi_data: Close
[0m19:29:49.916287 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mochi_data_dbt_mochi'
[0m19:29:49.916287 [debug] [ThreadPool]: Using postgres connection "list_mochi_data_dbt_mochi"
[0m19:29:49.916287 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: BEGIN
[0m19:29:49.916287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:49.952015 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m19:29:49.952015 [debug] [ThreadPool]: Using postgres connection "list_mochi_data_dbt_mochi"
[0m19:29:49.952015 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "list_mochi_data_dbt_mochi"} */
select
      'mochi_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_mochi'
    union all
    select
      'mochi_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_mochi'
    union all
    select
      'mochi_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_mochi'
  
[0m19:29:49.952015 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m19:29:49.952015 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: ROLLBACK
[0m19:29:49.952015 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: Close
[0m19:29:49.952015 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:49.952015 [debug] [MainThread]: On master: BEGIN
[0m19:29:49.952015 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:29:49.987378 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m19:29:49.988379 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:49.988379 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:29:49.993370 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m19:29:49.995370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5822d221-d6e0-4bfa-94c4-2850027d5b12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A162139D0>]}
[0m19:29:49.995370 [debug] [MainThread]: On master: ROLLBACK
[0m19:29:49.995370 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:49.996370 [debug] [MainThread]: On master: BEGIN
[0m19:29:49.996370 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:29:49.996370 [debug] [MainThread]: On master: COMMIT
[0m19:29:49.997371 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:49.997371 [debug] [MainThread]: On master: COMMIT
[0m19:29:49.998371 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:29:49.998371 [debug] [MainThread]: On master: Close
[0m19:29:50.000371 [debug] [Thread-1  ]: Began running node model.mochi_analysis.my_first_dbt_model
[0m19:29:50.000371 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_mochi.my_first_dbt_model ...................... [RUN]
[0m19:29:50.001371 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.mochi_analysis.my_first_dbt_model'
[0m19:29:50.002014 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.my_first_dbt_model
[0m19:29:50.002014 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.my_first_dbt_model"
[0m19:29:50.002014 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.my_first_dbt_model
[0m19:29:50.035806 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.my_first_dbt_model"
[0m19:29:50.035806 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:29:50.035806 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: BEGIN
[0m19:29:50.035806 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:29:50.065150 [debug] [Thread-1  ]: SQL status: BEGIN in 0.026 seconds
[0m19:29:50.065150 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:29:50.065150 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */

  
    

  create  table "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:29:50.068804 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.003 seconds
[0m19:29:50.076804 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:29:50.076804 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:29:50.077804 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:29:50.079805 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:29:50.079805 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:29:50.079805 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:29:50.085815 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: COMMIT
[0m19:29:50.085815 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:29:50.085815 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: COMMIT
[0m19:29:50.085815 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m19:29:50.085815 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_backup"
[0m19:29:50.101366 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:29:50.101869 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
drop table if exists "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_backup" cascade
[0m19:29:50.101869 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m19:29:50.101869 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: Close
[0m19:29:50.101869 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5822d221-d6e0-4bfa-94c4-2850027d5b12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A17AE7AF0>]}
[0m19:29:50.101869 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_mochi.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.10s]
[0m19:29:50.101869 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.my_first_dbt_model
[0m19:29:50.101869 [debug] [Thread-1  ]: Began running node model.mochi_analysis.stg_panel_evaluations
[0m19:29:50.101869 [info ] [Thread-1  ]: 2 of 4 START sql view model dbt_mochi.stg_panel_evaluations .................... [RUN]
[0m19:29:50.101869 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.my_first_dbt_model, now model.mochi_analysis.stg_panel_evaluations)
[0m19:29:50.101869 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.stg_panel_evaluations
[0m19:29:50.101869 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.stg_panel_evaluations"
[0m19:29:50.101869 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.stg_panel_evaluations
[0m19:29:50.127444 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.stg_panel_evaluations"
[0m19:29:50.128444 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:29:50.128444 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: BEGIN
[0m19:29:50.129445 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:29:50.152298 [debug] [Thread-1  ]: SQL status: BEGIN in 0.027 seconds
[0m19:29:50.152298 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:29:50.152298 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */

  create view "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_tmp"
    
    
  as (
    -- models/Staging/stg_panel_evaluations.sql

select
    "Timestamp" as raw_timestamp,
    -- Formulation 1 (original columns, likely without a suffix)
    "Bitterness" as bitterness_1,
    "Sweetness" as sweetness_1,
    "Chamomile Flavour" as chamomile_flavour_1,
    "Honey Flavour" as honey_flavour_1,         
    "Creaminess" as creaminess_1,               
    "Overall Acceptability" as overall_acceptability_1, 

    -- Formulation 2 (these will be .1 suffix if starting from 0 index, or .2 if first is 1)
    "Bitterness.1" as bitterness_2,           
    "Sweetness.1" as sweetness_2,               
    "Chamomile Flavour.1" as chamomile_flavour_2, 
    "Honey Flavour.1" as honey_flavour_2,
    "Creaminess.1" as creaminess_2,
    "Overall Acceptability.1" as overall_acceptability_2,

    -- Formulation 3 (these will be .2 suffix)
    "Bitterness.2" as bitterness_3,             
    "Sweetness.2" as sweetness_3,
    "Chamomile Flavour.2" as chamomile_flavour_3,
    "Honey Flavour.2" as honey_flavour_3,
    "Creaminess.2" as creaminess_3,
    "Overall Acceptability.2" as overall_acceptability_3,

    -- Formulation 4 (these will be .3 suffix)
    "Bitterness.3" as bitterness_4,
    "Sweetness.3" as sweetness_4,
    "Chamomile Flavour.3" as chamomile_flavour_4,
    "Honey Flavour.3" as honey_flavour_4,
    "Creaminess.3" as creaminess_4,
    "Overall Acceptability.3" as overall_acceptability_4,

    -- Formulation 5 (these will be .4 suffix)
    "Bitterness.4" as bitterness_5,
    "Sweetness.4" as sweetness_5,
    "Chamomile Flavour.4" as chamomile_flavour_5,
    "Honey Flavour.4" as honey_flavour_5,
    "Creaminess.4" as creaminess_5,
    "Overall Acceptability.4" as overall_acceptability_5

from "mochi_data"."public"."raw_panel_evaluations"
  );
[0m19:29:50.152298 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m19:29:50.161836 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:29:50.161836 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
alter table "mochi_data"."dbt_mochi"."stg_panel_evaluations" rename to "stg_panel_evaluations__dbt_backup"
[0m19:29:50.161836 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:29:50.161836 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:29:50.161836 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
alter table "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_tmp" rename to "stg_panel_evaluations"
[0m19:29:50.161836 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:29:50.168954 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: COMMIT
[0m19:29:50.168954 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:29:50.168954 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: COMMIT
[0m19:29:50.168954 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m19:29:50.171957 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_backup"
[0m19:29:50.171957 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:29:50.171957 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
drop view if exists "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_backup" cascade
[0m19:29:50.171957 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m19:29:50.171957 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: Close
[0m19:29:50.171957 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5822d221-d6e0-4bfa-94c4-2850027d5b12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A152F0AC0>]}
[0m19:29:50.171957 [info ] [Thread-1  ]: 2 of 4 OK created sql view model dbt_mochi.stg_panel_evaluations ............... [[32mCREATE VIEW[0m in 0.07s]
[0m19:29:50.171957 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.stg_panel_evaluations
[0m19:29:50.171957 [debug] [Thread-1  ]: Began running node model.mochi_analysis.my_second_dbt_model
[0m19:29:50.171957 [info ] [Thread-1  ]: 3 of 4 START sql view model dbt_mochi.my_second_dbt_model ...................... [RUN]
[0m19:29:50.171957 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.stg_panel_evaluations, now model.mochi_analysis.my_second_dbt_model)
[0m19:29:50.171957 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.my_second_dbt_model
[0m19:29:50.171957 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.my_second_dbt_model"
[0m19:29:50.171957 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.my_second_dbt_model
[0m19:29:50.186472 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.my_second_dbt_model"
[0m19:29:50.187900 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:29:50.187900 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: BEGIN
[0m19:29:50.188900 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:29:50.317632 [debug] [Thread-1  ]: SQL status: BEGIN in 0.134 seconds
[0m19:29:50.317632 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:29:50.317632 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */

  create view "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "mochi_data"."dbt_mochi"."my_first_dbt_model"
where id = 1
  );
[0m19:29:50.317632 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:29:50.317632 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:29:50.317632 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:29:50.317632 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:29:50.317632 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: COMMIT
[0m19:29:50.317632 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:29:50.317632 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: COMMIT
[0m19:29:50.333258 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m19:29:50.333258 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_backup"
[0m19:29:50.333258 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:29:50.333258 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */
drop view if exists "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_backup" cascade
[0m19:29:50.333258 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m19:29:50.333258 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: Close
[0m19:29:50.333258 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5822d221-d6e0-4bfa-94c4-2850027d5b12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A17BC5E20>]}
[0m19:29:50.333258 [info ] [Thread-1  ]: 3 of 4 OK created sql view model dbt_mochi.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.16s]
[0m19:29:50.333258 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.my_second_dbt_model
[0m19:29:50.333258 [debug] [Thread-1  ]: Began running node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m19:29:50.333258 [info ] [Thread-1  ]: 4 of 4 START sql view model dbt_mochi.fct_panel_evaluations_unpivoted .......... [RUN]
[0m19:29:50.333258 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.my_second_dbt_model, now model.mochi_analysis.fct_panel_evaluations_unpivoted)
[0m19:29:50.333258 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m19:29:50.333258 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m19:29:50.333258 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m19:29:50.333258 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m19:29:50.333258 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m19:29:50.333258 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: BEGIN
[0m19:29:50.333258 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:29:50.372201 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m19:29:50.373201 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m19:29:50.373201 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.fct_panel_evaluations_unpivoted"} */

  create view "mochi_data"."dbt_mochi"."fct_panel_evaluations_unpivoted__dbt_tmp"
    
    
  as (
    -- models/fct_panel_evaluations_unpivoted.sql

SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '1' AS Formulation,
    bitterness_1 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_1, STRPOS(sweetness_1, '(') + 1, STRPOS(sweetness_1, ')') - STRPOS(sweetness_1, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_1, STRPOS(chamomile_flavour_1, '(') + 1, STRPOS(chamomile_flavour_1, ')') - STRPOS(chamomile_flavour_1, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_1, STRPOS(honey_flavour_1, '(') + 1, STRPOS(honey_flavour_1, ')') - STRPOS(honey_flavour_1, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_1, STRPOS(creaminess_1, '(') + 1, STRPOS(creaminess_1, ')') - STRPOS(creaminess_1, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_1 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '2' AS Formulation,
    bitterness_2 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_2, STRPOS(sweetness_2, '(') + 1, STRPOS(sweetness_2, ')') - STRPOS(sweetness_2, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_2, STRPOS(chamomile_flavour_2, '(') + 1, STRPOS(chamomile_flavour_2, ')') - STRPOS(chamomile_flavour_2, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_2, STRPOS(honey_flavour_2, '(') + 1, STRPOS(honey_flavour_2, ')') - STRPOS(honey_flavour_2, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_2, STRPOS(creaminess_2, '(') + 1, STRPOS(creaminess_2, ')') - STRPOS(creaminess_2, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_2 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

-- Repeat for Flavor 3
SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '3' AS Formulation,
    bitterness_3 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_3, STRPOS(sweetness_3, '(') + 1, STRPOS(sweetness_3, ')') - STRPOS(sweetness_3, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_3, STRPOS(chamomile_flavour_3, '(') + 1, STRPOS(chamomile_flavour_3, ')') - STRPOS(chamomile_flavour_3, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_3, STRPOS(honey_flavour_3, '(') + 1, STRPOS(honey_flavour_3, ')') - STRPOS(honey_flavour_3, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_3, STRPOS(creaminess_3, '(') + 1, STRPOS(creaminess_3, ')') - STRPOS(creaminess_3, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_3 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

-- Repeat for Flavor 4
SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '4' AS Formulation,
    bitterness_4 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_4, STRPOS(sweetness_4, '(') + 1, STRPOS(sweetness_4, ')') - STRPOS(sweetness_4, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_4, STRPOS(chamomile_flavour_4, '(') + 1, STRPOS(chamomile_flavour_4, ')') - STRPOS(chamomile_flavour_4, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_4, STRPOS(honey_flavour_4, '(') + 1, STRPOS(honey_flavour_4, ')') - STRPOS(honey_flavour_4, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_4, STRPOS(creaminess_4, '(') + 1, STRPOS(creaminess_4, ')') - STRPOS(creaminess_4, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_4 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

-- Repeat for Flavor 5
SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '5' AS Formulation,
    bitterness_5 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_5, STRPOS(sweetness_5, '(') + 1, STRPOS(sweetness_5, ')') - STRPOS(sweetness_5, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_5, STRPOS(chamomile_flavour_5, '(') + 1, STRPOS(chamomile_flavour_5, ')') - STRPOS(chamomile_flavour_5, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_5, STRPOS(honey_flavour_5, '(') + 1, STRPOS(honey_flavour_5, ')') - STRPOS(honey_flavour_5, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_5, STRPOS(creaminess_5, '(') + 1, STRPOS(creaminess_5, ')') - STRPOS(creaminess_5, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_5 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1
  );
[0m19:29:50.375213 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m19:29:50.375213 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m19:29:50.375213 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.fct_panel_evaluations_unpivoted"} */
alter table "mochi_data"."dbt_mochi"."fct_panel_evaluations_unpivoted__dbt_tmp" rename to "fct_panel_evaluations_unpivoted"
[0m19:29:50.375213 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:29:50.375213 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: COMMIT
[0m19:29:50.375213 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m19:29:50.385354 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: COMMIT
[0m19:29:50.385953 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m19:29:50.385953 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."fct_panel_evaluations_unpivoted__dbt_backup"
[0m19:29:50.385953 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m19:29:50.385953 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.fct_panel_evaluations_unpivoted"} */
drop view if exists "mochi_data"."dbt_mochi"."fct_panel_evaluations_unpivoted__dbt_backup" cascade
[0m19:29:50.385953 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m19:29:50.385953 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: Close
[0m19:29:50.385953 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5822d221-d6e0-4bfa-94c4-2850027d5b12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A17BC54C0>]}
[0m19:29:50.385953 [info ] [Thread-1  ]: 4 of 4 OK created sql view model dbt_mochi.fct_panel_evaluations_unpivoted ..... [[32mCREATE VIEW[0m in 0.05s]
[0m19:29:50.385953 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m19:29:50.385953 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:50.385953 [debug] [MainThread]: On master: BEGIN
[0m19:29:50.385953 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:29:50.407271 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m19:29:50.407271 [debug] [MainThread]: On master: COMMIT
[0m19:29:50.419441 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:50.419441 [debug] [MainThread]: On master: COMMIT
[0m19:29:50.419441 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:29:50.419441 [debug] [MainThread]: On master: Close
[0m19:29:50.419441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:29:50.419441 [debug] [MainThread]: Connection 'list_mochi_data' was properly closed.
[0m19:29:50.419441 [debug] [MainThread]: Connection 'list_mochi_data_dbt_mochi' was properly closed.
[0m19:29:50.419441 [debug] [MainThread]: Connection 'model.mochi_analysis.fct_panel_evaluations_unpivoted' was properly closed.
[0m19:29:50.419441 [info ] [MainThread]: 
[0m19:29:50.419441 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m19:29:50.419441 [debug] [MainThread]: Command end result
[0m19:29:50.439638 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\manifest.json
[0m19:29:50.441651 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\semantic_manifest.json
[0m19:29:50.441651 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\run_results.json
[0m19:29:50.441651 [info ] [MainThread]: 
[0m19:29:50.441651 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:29:50.448637 [info ] [MainThread]: 
[0m19:29:50.448637 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:29:50.449636 [debug] [MainThread]: Command `dbt run` succeeded at 19:29:50.449636 after 1.81 seconds
[0m19:29:50.449636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A14F832B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A1670DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A16702250>]}
[0m19:29:50.450636 [debug] [MainThread]: Flushing usage events
[0m19:29:51.352566 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:34:02.276689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181D97E32B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181DA8A5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181DA8A5580>]}


============================== 19:34:02.280370 | 2b52c0e0-c98b-4b08-a2a7-f6de3c63621e ==============================
[0m19:34:02.280370 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:34:02.280370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\amiru\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\amiru\\Documents\\mochi_dbt\\mochi_analysis\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:34:02.452340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b52c0e0-c98b-4b08-a2a7-f6de3c63621e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181D6D90190>]}
[0m19:34:02.499218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b52c0e0-c98b-4b08-a2a7-f6de3c63621e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181D6EC2910>]}
[0m19:34:02.499218 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:34:02.758475 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:34:02.965265 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:34:02.965265 [debug] [MainThread]: Partial parsing: updated file: mochi_analysis://models\Staging\stg_panel_evaluations.sql
[0m19:34:03.167330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b52c0e0-c98b-4b08-a2a7-f6de3c63621e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181DB03EEB0>]}
[0m19:34:03.245461 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\manifest.json
[0m19:34:03.245461 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\semantic_manifest.json
[0m19:34:03.292340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b52c0e0-c98b-4b08-a2a7-f6de3c63621e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181DAF14070>]}
[0m19:34:03.292340 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 433 macros
[0m19:34:03.292340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b52c0e0-c98b-4b08-a2a7-f6de3c63621e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181DAF14850>]}
[0m19:34:03.292340 [info ] [MainThread]: 
[0m19:34:03.292340 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:34:03.292340 [info ] [MainThread]: 
[0m19:34:03.307966 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:34:03.307966 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mochi_data'
[0m19:34:03.384358 [debug] [ThreadPool]: Using postgres connection "list_mochi_data"
[0m19:34:03.384358 [debug] [ThreadPool]: On list_mochi_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "list_mochi_data"} */

    select distinct nspname from pg_namespace
  
[0m19:34:03.384358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:03.408417 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.037 seconds
[0m19:34:03.408417 [debug] [ThreadPool]: On list_mochi_data: Close
[0m19:34:03.424043 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mochi_data_dbt_mochi'
[0m19:34:03.424043 [debug] [ThreadPool]: Using postgres connection "list_mochi_data_dbt_mochi"
[0m19:34:03.424043 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: BEGIN
[0m19:34:03.424043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:03.439668 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m19:34:03.439668 [debug] [ThreadPool]: Using postgres connection "list_mochi_data_dbt_mochi"
[0m19:34:03.439668 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "list_mochi_data_dbt_mochi"} */
select
      'mochi_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_mochi'
    union all
    select
      'mochi_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_mochi'
    union all
    select
      'mochi_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_mochi'
  
[0m19:34:03.455818 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m19:34:03.455818 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: ROLLBACK
[0m19:34:03.455818 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: Close
[0m19:34:03.462365 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:03.462365 [debug] [MainThread]: On master: BEGIN
[0m19:34:03.462365 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:34:03.482052 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m19:34:03.482052 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:03.482052 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:34:03.482052 [debug] [MainThread]: SQL status: SELECT 3 in 0.006 seconds
[0m19:34:03.482052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b52c0e0-c98b-4b08-a2a7-f6de3c63621e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181DAA23610>]}
[0m19:34:03.497680 [debug] [MainThread]: On master: ROLLBACK
[0m19:34:03.497680 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:03.497680 [debug] [MainThread]: On master: BEGIN
[0m19:34:03.497680 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:34:03.497680 [debug] [MainThread]: On master: COMMIT
[0m19:34:03.497680 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:03.497680 [debug] [MainThread]: On master: COMMIT
[0m19:34:03.497680 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:34:03.497680 [debug] [MainThread]: On master: Close
[0m19:34:03.497680 [debug] [Thread-1  ]: Began running node model.mochi_analysis.my_first_dbt_model
[0m19:34:03.497680 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_mochi.my_first_dbt_model ...................... [RUN]
[0m19:34:03.497680 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.mochi_analysis.my_first_dbt_model'
[0m19:34:03.497680 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.my_first_dbt_model
[0m19:34:03.497680 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.my_first_dbt_model"
[0m19:34:03.497680 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.my_first_dbt_model
[0m19:34:03.525070 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.my_first_dbt_model"
[0m19:34:03.525070 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:34:03.525070 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: BEGIN
[0m19:34:03.525070 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:34:03.565059 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m19:34:03.566060 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:34:03.566060 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */

  
    

  create  table "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:34:03.574012 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.007 seconds
[0m19:34:03.576038 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:34:03.576038 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:34:03.576038 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:34:03.576038 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:34:03.576038 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:34:03.576038 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:34:03.591663 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: COMMIT
[0m19:34:03.591663 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:34:03.591663 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: COMMIT
[0m19:34:03.591663 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m19:34:03.591663 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_backup"
[0m19:34:03.591663 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:34:03.591663 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
drop table if exists "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_backup" cascade
[0m19:34:03.607289 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m19:34:03.607289 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: Close
[0m19:34:03.607289 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b52c0e0-c98b-4b08-a2a7-f6de3c63621e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181DC34EBE0>]}
[0m19:34:03.607289 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_mochi.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.11s]
[0m19:34:03.607289 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.my_first_dbt_model
[0m19:34:03.607289 [debug] [Thread-1  ]: Began running node model.mochi_analysis.stg_panel_evaluations
[0m19:34:03.607289 [info ] [Thread-1  ]: 2 of 4 START sql view model dbt_mochi.stg_panel_evaluations .................... [RUN]
[0m19:34:03.607289 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.my_first_dbt_model, now model.mochi_analysis.stg_panel_evaluations)
[0m19:34:03.607289 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.stg_panel_evaluations
[0m19:34:03.607289 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.stg_panel_evaluations"
[0m19:34:03.607289 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.stg_panel_evaluations
[0m19:34:03.633399 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.stg_panel_evaluations"
[0m19:34:03.634400 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:34:03.634400 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: BEGIN
[0m19:34:03.635400 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:34:03.768489 [debug] [Thread-1  ]: SQL status: BEGIN in 0.139 seconds
[0m19:34:03.768489 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:34:03.768489 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */

  create view "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_tmp"
    
    
  as (
    -- models/Staging/stg_panel_evaluations.sql

select
    "Timestamp" as raw_timestamp,
    -- Formulation 1
    CAST("Bitterness" AS INTEGER) as bitterness_1,
    CAST("Sweetness" AS INTEGER) as sweetness_1,
    CAST("Chamomile Flavour" AS INTEGER) as chamomile_flavour_1,
    CAST("Honey Flavour" AS INTEGER) as honey_flavour_1,
    CAST("Creaminess" AS INTEGER) as creaminess_1,
    CAST("Overall Acceptability" AS INTEGER) as overall_acceptability_1,

    -- Formulation 2
    CAST("Bitterness.1" AS INTEGER) as bitterness_2,
    CAST("Sweetness.1" AS INTEGER) as sweetness_2,
    CAST("Chamomile Flavour.1" AS INTEGER) as chamomile_flavour_2,
    CAST("Honey Flavour.1" AS INTEGER) as honey_flavour_2,
    CAST("Creaminess.1" AS INTEGER) as creaminess_2,
    CAST("Overall Acceptability.1" AS INTEGER) as overall_acceptability_2,

    -- Formulation 3
    CAST("Bitterness.2" AS INTEGER) as bitterness_3,
    CAST("Sweetness.2" AS INTEGER) as sweetness_3,
    CAST("Chamomile Flavour.2" AS INTEGER) as chamomile_flavour_3,
    CAST("Honey Flavour.2" AS INTEGER) as honey_flavour_3,
    CAST("Creaminess.2" AS INTEGER) as creaminess_3,
    CAST("Overall Acceptability.2" AS INTEGER) as overall_acceptability_3,

    -- Formulation 4
    CAST("Bitterness.3" AS INTEGER) as bitterness_4,
    CAST("Sweetness.3" AS INTEGER) as sweetness_4,
    CAST("Chamomile Flavour.3" AS INTEGER) as chamomile_flavour_4,
    CAST("Honey Flavour.3" AS INTEGER) as honey_flavour_4,
    CAST("Creaminess.3" AS INTEGER) as creaminess_4,
    CAST("Overall Acceptability.3" AS INTEGER) as overall_acceptability_4,

    -- Formulation 5
    CAST("Bitterness.4" AS INTEGER) as bitterness_5,
    CAST("Sweetness.4" AS INTEGER) as sweetness_5,
    CAST("Chamomile Flavour.4" AS INTEGER) as chamomile_flavour_5,
    CAST("Honey Flavour.4" AS INTEGER) as honey_flavour_4,
    CAST("Creaminess.4" AS INTEGER) as creaminess_5,
    CAST("Overall Acceptability.4" AS INTEGER) as overall_acceptability_5

from "mochi_data"."public"."raw_panel_evaluations"
  );
[0m19:34:03.768489 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "honey_flavour_4" specified more than once

[0m19:34:03.768489 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: ROLLBACK
[0m19:34:03.768489 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: Close
[0m19:34:03.784115 [debug] [Thread-1  ]: Database Error in model stg_panel_evaluations (models\Staging\stg_panel_evaluations.sql)
  column "honey_flavour_4" specified more than once
  compiled code at target\run\mochi_analysis\models\Staging\stg_panel_evaluations.sql
[0m19:34:03.784115 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b52c0e0-c98b-4b08-a2a7-f6de3c63621e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181D9B4D9A0>]}
[0m19:34:03.784115 [error] [Thread-1  ]: 2 of 4 ERROR creating sql view model dbt_mochi.stg_panel_evaluations ........... [[31mERROR[0m in 0.18s]
[0m19:34:03.784115 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.stg_panel_evaluations
[0m19:34:03.784115 [debug] [Thread-1  ]: Began running node model.mochi_analysis.my_second_dbt_model
[0m19:34:03.784115 [debug] [Thread-4  ]: Marking all children of 'model.mochi_analysis.stg_panel_evaluations' to be skipped because of status 'error'.  Reason: Database Error in model stg_panel_evaluations (models\Staging\stg_panel_evaluations.sql)
  column "honey_flavour_4" specified more than once
  compiled code at target\run\mochi_analysis\models\Staging\stg_panel_evaluations.sql.
[0m19:34:03.784115 [info ] [Thread-1  ]: 3 of 4 START sql view model dbt_mochi.my_second_dbt_model ...................... [RUN]
[0m19:34:03.784115 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.stg_panel_evaluations, now model.mochi_analysis.my_second_dbt_model)
[0m19:34:03.784115 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.my_second_dbt_model
[0m19:34:03.784115 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.my_second_dbt_model"
[0m19:34:03.784115 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.my_second_dbt_model
[0m19:34:03.784115 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.my_second_dbt_model"
[0m19:34:03.784115 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:34:03.784115 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: BEGIN
[0m19:34:03.784115 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:34:03.814967 [debug] [Thread-1  ]: SQL status: BEGIN in 0.026 seconds
[0m19:34:03.814967 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:34:03.824611 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */

  create view "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "mochi_data"."dbt_mochi"."my_first_dbt_model"
where id = 1
  );
[0m19:34:03.825820 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m19:34:03.825820 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:34:03.825820 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:34:03.825820 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:34:03.825820 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: COMMIT
[0m19:34:03.825820 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:34:03.825820 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: COMMIT
[0m19:34:03.825820 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m19:34:03.825820 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_backup"
[0m19:34:03.825820 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:34:03.825820 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */
drop view if exists "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_backup" cascade
[0m19:34:03.825820 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m19:34:03.825820 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: Close
[0m19:34:03.841271 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b52c0e0-c98b-4b08-a2a7-f6de3c63621e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181DC587FD0>]}
[0m19:34:03.841944 [info ] [Thread-1  ]: 3 of 4 OK created sql view model dbt_mochi.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.06s]
[0m19:34:03.841944 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.my_second_dbt_model
[0m19:34:03.841944 [debug] [Thread-1  ]: Began running node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m19:34:03.841944 [info ] [Thread-1  ]: 4 of 4 SKIP relation dbt_mochi.fct_panel_evaluations_unpivoted ................. [[33mSKIP[0m]
[0m19:34:03.841944 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m19:34:03.841944 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:03.841944 [debug] [MainThread]: On master: BEGIN
[0m19:34:03.841944 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:34:03.863450 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m19:34:03.863450 [debug] [MainThread]: On master: COMMIT
[0m19:34:03.863450 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:03.863450 [debug] [MainThread]: On master: COMMIT
[0m19:34:03.863450 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:34:03.863450 [debug] [MainThread]: On master: Close
[0m19:34:03.863450 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:34:03.863450 [debug] [MainThread]: Connection 'list_mochi_data' was properly closed.
[0m19:34:03.863450 [debug] [MainThread]: Connection 'list_mochi_data_dbt_mochi' was properly closed.
[0m19:34:03.863450 [debug] [MainThread]: Connection 'model.mochi_analysis.my_second_dbt_model' was properly closed.
[0m19:34:03.863450 [info ] [MainThread]: 
[0m19:34:03.863450 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m19:34:03.873783 [debug] [MainThread]: Command end result
[0m19:34:03.879809 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\manifest.json
[0m19:34:03.892986 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\semantic_manifest.json
[0m19:34:03.897999 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\run_results.json
[0m19:34:03.897999 [info ] [MainThread]: 
[0m19:34:03.897999 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:34:03.897999 [info ] [MainThread]: 
[0m19:34:03.897999 [error] [MainThread]:   Database Error in model stg_panel_evaluations (models\Staging\stg_panel_evaluations.sql)
  column "honey_flavour_4" specified more than once
  compiled code at target\run\mochi_analysis\models\Staging\stg_panel_evaluations.sql
[0m19:34:03.897999 [info ] [MainThread]: 
[0m19:34:03.897999 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m19:34:03.897999 [debug] [MainThread]: Command `dbt run` failed at 19:34:03.897999 after 1.70 seconds
[0m19:34:03.897999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181D97E32B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181DAF53B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181DAF14070>]}
[0m19:34:03.897999 [debug] [MainThread]: Flushing usage events
[0m19:34:04.880493 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:34:28.869257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBD623280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBF697700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBF697550>]}


============================== 19:34:28.872259 | 86431e47-3757-46dc-8895-1fbd007a80e4 ==============================
[0m19:34:28.872259 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:34:28.872259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\amiru\\Documents\\mochi_dbt\\mochi_analysis\\logs', 'profiles_dir': 'C:\\Users\\amiru\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:34:29.011831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86431e47-3757-46dc-8895-1fbd007a80e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBF67D0D0>]}
[0m19:34:29.065168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86431e47-3757-46dc-8895-1fbd007a80e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBF66B5B0>]}
[0m19:34:29.066168 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:34:29.322624 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:34:29.486196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:34:29.486196 [debug] [MainThread]: Partial parsing: updated file: mochi_analysis://models\Staging\stg_panel_evaluations.sql
[0m19:34:29.689260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86431e47-3757-46dc-8895-1fbd007a80e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBFE3FE80>]}
[0m19:34:29.775925 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\manifest.json
[0m19:34:29.779969 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\semantic_manifest.json
[0m19:34:29.821073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86431e47-3757-46dc-8895-1fbd007a80e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBFDA4820>]}
[0m19:34:29.822073 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 433 macros
[0m19:34:29.822073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86431e47-3757-46dc-8895-1fbd007a80e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBFDA46D0>]}
[0m19:34:29.823644 [info ] [MainThread]: 
[0m19:34:29.823644 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:34:29.823644 [info ] [MainThread]: 
[0m19:34:29.823644 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:34:29.823644 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mochi_data'
[0m19:34:29.890880 [debug] [ThreadPool]: Using postgres connection "list_mochi_data"
[0m19:34:29.890880 [debug] [ThreadPool]: On list_mochi_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "list_mochi_data"} */

    select distinct nspname from pg_namespace
  
[0m19:34:29.890880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:29.928647 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.029 seconds
[0m19:34:29.929647 [debug] [ThreadPool]: On list_mochi_data: Close
[0m19:34:29.930647 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mochi_data_dbt_mochi'
[0m19:34:29.935649 [debug] [ThreadPool]: Using postgres connection "list_mochi_data_dbt_mochi"
[0m19:34:29.935649 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: BEGIN
[0m19:34:29.935649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:29.955918 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m19:34:29.955918 [debug] [ThreadPool]: Using postgres connection "list_mochi_data_dbt_mochi"
[0m19:34:29.955918 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "list_mochi_data_dbt_mochi"} */
select
      'mochi_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_mochi'
    union all
    select
      'mochi_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_mochi'
    union all
    select
      'mochi_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_mochi'
  
[0m19:34:29.955918 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m19:34:29.955918 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: ROLLBACK
[0m19:34:29.955918 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: Close
[0m19:34:29.955918 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:29.955918 [debug] [MainThread]: On master: BEGIN
[0m19:34:29.955918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:34:29.987170 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m19:34:29.987170 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:29.987170 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:34:29.987170 [debug] [MainThread]: SQL status: SELECT 3 in 0.005 seconds
[0m19:34:30.002796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86431e47-3757-46dc-8895-1fbd007a80e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBC513550>]}
[0m19:34:30.002796 [debug] [MainThread]: On master: ROLLBACK
[0m19:34:30.002796 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:30.002796 [debug] [MainThread]: On master: BEGIN
[0m19:34:30.002796 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:34:30.002796 [debug] [MainThread]: On master: COMMIT
[0m19:34:30.002796 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:30.002796 [debug] [MainThread]: On master: COMMIT
[0m19:34:30.002796 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:34:30.002796 [debug] [MainThread]: On master: Close
[0m19:34:30.002796 [debug] [Thread-1  ]: Began running node model.mochi_analysis.my_first_dbt_model
[0m19:34:30.002796 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_mochi.my_first_dbt_model ...................... [RUN]
[0m19:34:30.002796 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.mochi_analysis.my_first_dbt_model'
[0m19:34:30.002796 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.my_first_dbt_model
[0m19:34:30.002796 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.my_first_dbt_model"
[0m19:34:30.002796 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.my_first_dbt_model
[0m19:34:30.044278 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.my_first_dbt_model"
[0m19:34:30.045279 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:34:30.045279 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: BEGIN
[0m19:34:30.045279 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:34:30.176887 [debug] [Thread-1  ]: SQL status: BEGIN in 0.136 seconds
[0m19:34:30.176887 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:34:30.176887 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */

  
    

  create  table "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:34:30.176887 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.003 seconds
[0m19:34:30.192513 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:34:30.192513 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:34:30.192513 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:34:30.192513 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:34:30.192513 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:34:30.192513 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:34:30.192513 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: COMMIT
[0m19:34:30.208139 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:34:30.208139 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: COMMIT
[0m19:34:30.208139 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m19:34:30.208139 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_backup"
[0m19:34:30.208139 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:34:30.208139 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
drop table if exists "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_backup" cascade
[0m19:34:30.208139 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m19:34:30.208139 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: Close
[0m19:34:30.208139 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86431e47-3757-46dc-8895-1fbd007a80e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FC114EBB0>]}
[0m19:34:30.208139 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_mochi.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.21s]
[0m19:34:30.223765 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.my_first_dbt_model
[0m19:34:30.223765 [debug] [Thread-1  ]: Began running node model.mochi_analysis.stg_panel_evaluations
[0m19:34:30.223765 [info ] [Thread-1  ]: 2 of 4 START sql view model dbt_mochi.stg_panel_evaluations .................... [RUN]
[0m19:34:30.223765 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.my_first_dbt_model, now model.mochi_analysis.stg_panel_evaluations)
[0m19:34:30.223765 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.stg_panel_evaluations
[0m19:34:30.223765 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.stg_panel_evaluations"
[0m19:34:30.223765 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.stg_panel_evaluations
[0m19:34:30.241865 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.stg_panel_evaluations"
[0m19:34:30.241865 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:34:30.242866 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: BEGIN
[0m19:34:30.242866 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:34:30.262097 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m19:34:30.262097 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:34:30.262097 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */

  create view "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_tmp"
    
    
  as (
    -- models/Staging/stg_panel_evaluations.sql

select
    "Timestamp" as raw_timestamp,
    -- Formulation 1
    CAST("Bitterness" AS INTEGER) as bitterness_1,
    CAST("Sweetness" AS INTEGER) as sweetness_1,
    CAST("Chamomile Flavour" AS INTEGER) as chamomile_flavour_1,
    CAST("Honey Flavour" AS INTEGER) as honey_flavour_1,
    CAST("Creaminess" AS INTEGER) as creaminess_1,
    CAST("Overall Acceptability" AS INTEGER) as overall_acceptability_1,

    -- Formulation 2
    CAST("Bitterness.1" AS INTEGER) as bitterness_2,
    CAST("Sweetness.1" AS INTEGER) as sweetness_2,
    CAST("Chamomile Flavour.1" AS INTEGER) as chamomile_flavour_2,
    CAST("Honey Flavour.1" AS INTEGER) as honey_flavour_2,
    CAST("Creaminess.1" AS INTEGER) as creaminess_2,
    CAST("Overall Acceptability.1" AS INTEGER) as overall_acceptability_2,

    -- Formulation 3
    CAST("Bitterness.2" AS INTEGER) as bitterness_3,
    CAST("Sweetness.2" AS INTEGER) as sweetness_3,
    CAST("Chamomile Flavour.2" AS INTEGER) as chamomile_flavour_3,
    CAST("Honey Flavour.2" AS INTEGER) as honey_flavour_3,
    CAST("Creaminess.2" AS INTEGER) as creaminess_3,
    CAST("Overall Acceptability.2" AS INTEGER) as overall_acceptability_3,

    -- Formulation 4
    CAST("Bitterness.3" AS INTEGER) as bitterness_4,
    CAST("Sweetness.3" AS INTEGER) as sweetness_4,
    CAST("Chamomile Flavour.3" AS INTEGER) as chamomile_flavour_4,
    CAST("Honey Flavour.3" AS INTEGER) as honey_flavour_4,
    CAST("Creaminess.3" AS INTEGER) as creaminess_4,
    CAST("Overall Acceptability.3" AS INTEGER) as overall_acceptability_4,

    -- Formulation 5
    CAST("Bitterness.4" AS INTEGER) as bitterness_5,
    CAST("Sweetness.4" AS INTEGER) as sweetness_5,
    CAST("Chamomile Flavour.4" AS INTEGER) as chamomile_flavour_5,
    CAST("Honey Flavour.4" AS INTEGER) as honey_flavour_5,
    CAST("Creaminess.4" AS INTEGER) as creaminess_5,
    CAST("Overall Acceptability.4" AS INTEGER) as overall_acceptability_5

from "mochi_data"."public"."raw_panel_evaluations"
  );
[0m19:34:30.273872 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.008 seconds
[0m19:34:30.273872 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:34:30.273872 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
alter table "mochi_data"."dbt_mochi"."stg_panel_evaluations" rename to "stg_panel_evaluations__dbt_backup"
[0m19:34:30.273872 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:34:30.273872 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:34:30.273872 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
alter table "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_tmp" rename to "stg_panel_evaluations"
[0m19:34:30.273872 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:34:30.273872 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: COMMIT
[0m19:34:30.273872 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:34:30.273872 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: COMMIT
[0m19:34:30.273872 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m19:34:30.273872 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_backup"
[0m19:34:30.290279 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:34:30.290518 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
drop view if exists "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_backup" cascade
[0m19:34:30.290518 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m19:34:30.290518 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: Close
[0m19:34:30.290518 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86431e47-3757-46dc-8895-1fbd007a80e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBE972FA0>]}
[0m19:34:30.290518 [info ] [Thread-1  ]: 2 of 4 OK created sql view model dbt_mochi.stg_panel_evaluations ............... [[32mCREATE VIEW[0m in 0.07s]
[0m19:34:30.290518 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.stg_panel_evaluations
[0m19:34:30.290518 [debug] [Thread-1  ]: Began running node model.mochi_analysis.my_second_dbt_model
[0m19:34:30.290518 [info ] [Thread-1  ]: 3 of 4 START sql view model dbt_mochi.my_second_dbt_model ...................... [RUN]
[0m19:34:30.290518 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.stg_panel_evaluations, now model.mochi_analysis.my_second_dbt_model)
[0m19:34:30.290518 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.my_second_dbt_model
[0m19:34:30.290518 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.my_second_dbt_model"
[0m19:34:30.290518 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.my_second_dbt_model
[0m19:34:30.290518 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.my_second_dbt_model"
[0m19:34:30.290518 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:34:30.290518 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: BEGIN
[0m19:34:30.290518 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:34:30.328573 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m19:34:30.329573 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:34:30.329573 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */

  create view "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "mochi_data"."dbt_mochi"."my_first_dbt_model"
where id = 1
  );
[0m19:34:30.330588 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:34:30.330588 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:34:30.330588 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:34:30.330588 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:34:30.330588 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: COMMIT
[0m19:34:30.330588 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:34:30.330588 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: COMMIT
[0m19:34:30.330588 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m19:34:30.340276 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_backup"
[0m19:34:30.340276 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:34:30.341379 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */
drop view if exists "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_backup" cascade
[0m19:34:30.341379 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m19:34:30.341379 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: Close
[0m19:34:30.341379 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86431e47-3757-46dc-8895-1fbd007a80e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBE972FA0>]}
[0m19:34:30.341379 [info ] [Thread-1  ]: 3 of 4 OK created sql view model dbt_mochi.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.05s]
[0m19:34:30.341379 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.my_second_dbt_model
[0m19:34:30.341379 [debug] [Thread-1  ]: Began running node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m19:34:30.341379 [info ] [Thread-1  ]: 4 of 4 START sql view model dbt_mochi.fct_panel_evaluations_unpivoted .......... [RUN]
[0m19:34:30.341379 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.my_second_dbt_model, now model.mochi_analysis.fct_panel_evaluations_unpivoted)
[0m19:34:30.341379 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m19:34:30.341379 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m19:34:30.341379 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m19:34:30.341379 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m19:34:30.341379 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m19:34:30.341379 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: BEGIN
[0m19:34:30.341379 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:34:30.377934 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m19:34:30.378934 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m19:34:30.378934 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.fct_panel_evaluations_unpivoted"} */

  create view "mochi_data"."dbt_mochi"."fct_panel_evaluations_unpivoted__dbt_tmp"
    
    
  as (
    -- models/fct_panel_evaluations_unpivoted.sql

SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '1' AS Formulation,
    bitterness_1 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_1, STRPOS(sweetness_1, '(') + 1, STRPOS(sweetness_1, ')') - STRPOS(sweetness_1, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_1, STRPOS(chamomile_flavour_1, '(') + 1, STRPOS(chamomile_flavour_1, ')') - STRPOS(chamomile_flavour_1, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_1, STRPOS(honey_flavour_1, '(') + 1, STRPOS(honey_flavour_1, ')') - STRPOS(honey_flavour_1, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_1, STRPOS(creaminess_1, '(') + 1, STRPOS(creaminess_1, ')') - STRPOS(creaminess_1, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_1 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '2' AS Formulation,
    bitterness_2 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_2, STRPOS(sweetness_2, '(') + 1, STRPOS(sweetness_2, ')') - STRPOS(sweetness_2, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_2, STRPOS(chamomile_flavour_2, '(') + 1, STRPOS(chamomile_flavour_2, ')') - STRPOS(chamomile_flavour_2, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_2, STRPOS(honey_flavour_2, '(') + 1, STRPOS(honey_flavour_2, ')') - STRPOS(honey_flavour_2, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_2, STRPOS(creaminess_2, '(') + 1, STRPOS(creaminess_2, ')') - STRPOS(creaminess_2, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_2 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

-- Repeat for Flavor 3
SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '3' AS Formulation,
    bitterness_3 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_3, STRPOS(sweetness_3, '(') + 1, STRPOS(sweetness_3, ')') - STRPOS(sweetness_3, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_3, STRPOS(chamomile_flavour_3, '(') + 1, STRPOS(chamomile_flavour_3, ')') - STRPOS(chamomile_flavour_3, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_3, STRPOS(honey_flavour_3, '(') + 1, STRPOS(honey_flavour_3, ')') - STRPOS(honey_flavour_3, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_3, STRPOS(creaminess_3, '(') + 1, STRPOS(creaminess_3, ')') - STRPOS(creaminess_3, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_3 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

-- Repeat for Flavor 4
SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '4' AS Formulation,
    bitterness_4 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_4, STRPOS(sweetness_4, '(') + 1, STRPOS(sweetness_4, ')') - STRPOS(sweetness_4, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_4, STRPOS(chamomile_flavour_4, '(') + 1, STRPOS(chamomile_flavour_4, ')') - STRPOS(chamomile_flavour_4, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_4, STRPOS(honey_flavour_4, '(') + 1, STRPOS(honey_flavour_4, ')') - STRPOS(honey_flavour_4, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_4, STRPOS(creaminess_4, '(') + 1, STRPOS(creaminess_4, ')') - STRPOS(creaminess_4, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_4 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

-- Repeat for Flavor 5
SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '5' AS Formulation,
    bitterness_5 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_5, STRPOS(sweetness_5, '(') + 1, STRPOS(sweetness_5, ')') - STRPOS(sweetness_5, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_5, STRPOS(chamomile_flavour_5, '(') + 1, STRPOS(chamomile_flavour_5, ')') - STRPOS(chamomile_flavour_5, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_5, STRPOS(honey_flavour_5, '(') + 1, STRPOS(honey_flavour_5, ')') - STRPOS(honey_flavour_5, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_5, STRPOS(creaminess_5, '(') + 1, STRPOS(creaminess_5, ')') - STRPOS(creaminess_5, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_5 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1
  );
[0m19:34:30.391329 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function strpos(integer, unknown) does not exist
LINE 13:     CAST(NULLIF(SUBSTRING(sweetness_1, STRPOS(sweetness_1, '...
                                                ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m19:34:30.391329 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: ROLLBACK
[0m19:34:30.391329 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: Close
[0m19:34:30.391329 [debug] [Thread-1  ]: Database Error in model fct_panel_evaluations_unpivoted (models\fct_panel_evaluations_unpivoted.sql)
  function strpos(integer, unknown) does not exist
  LINE 13:     CAST(NULLIF(SUBSTRING(sweetness_1, STRPOS(sweetness_1, '...
                                                  ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\mochi_analysis\models\fct_panel_evaluations_unpivoted.sql
[0m19:34:30.391329 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86431e47-3757-46dc-8895-1fbd007a80e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FC1326D00>]}
[0m19:34:30.391329 [error] [Thread-1  ]: 4 of 4 ERROR creating sql view model dbt_mochi.fct_panel_evaluations_unpivoted . [[31mERROR[0m in 0.05s]
[0m19:34:30.391329 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m19:34:30.391329 [debug] [Thread-4  ]: Marking all children of 'model.mochi_analysis.fct_panel_evaluations_unpivoted' to be skipped because of status 'error'.  Reason: Database Error in model fct_panel_evaluations_unpivoted (models\fct_panel_evaluations_unpivoted.sql)
  function strpos(integer, unknown) does not exist
  LINE 13:     CAST(NULLIF(SUBSTRING(sweetness_1, STRPOS(sweetness_1, '...
                                                  ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\mochi_analysis\models\fct_panel_evaluations_unpivoted.sql.
[0m19:34:30.391329 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:30.391329 [debug] [MainThread]: On master: BEGIN
[0m19:34:30.391329 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:34:30.514116 [debug] [MainThread]: SQL status: BEGIN in 0.127 seconds
[0m19:34:30.514116 [debug] [MainThread]: On master: COMMIT
[0m19:34:30.514116 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:30.514116 [debug] [MainThread]: On master: COMMIT
[0m19:34:30.514116 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:34:30.514116 [debug] [MainThread]: On master: Close
[0m19:34:30.514116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:34:30.514116 [debug] [MainThread]: Connection 'list_mochi_data' was properly closed.
[0m19:34:30.514116 [debug] [MainThread]: Connection 'list_mochi_data_dbt_mochi' was properly closed.
[0m19:34:30.514116 [debug] [MainThread]: Connection 'model.mochi_analysis.fct_panel_evaluations_unpivoted' was properly closed.
[0m19:34:30.529783 [info ] [MainThread]: 
[0m19:34:30.530286 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m19:34:30.530286 [debug] [MainThread]: Command end result
[0m19:34:30.547515 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\manifest.json
[0m19:34:30.549400 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\semantic_manifest.json
[0m19:34:30.553412 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\run_results.json
[0m19:34:30.553412 [info ] [MainThread]: 
[0m19:34:30.553412 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:34:30.555814 [info ] [MainThread]: 
[0m19:34:30.555814 [error] [MainThread]:   Database Error in model fct_panel_evaluations_unpivoted (models\fct_panel_evaluations_unpivoted.sql)
  function strpos(integer, unknown) does not exist
  LINE 13:     CAST(NULLIF(SUBSTRING(sweetness_1, STRPOS(sweetness_1, '...
                                                  ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\mochi_analysis\models\fct_panel_evaluations_unpivoted.sql
[0m19:34:30.556813 [info ] [MainThread]: 
[0m19:34:30.556813 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:34:30.558096 [debug] [MainThread]: Command `dbt run` failed at 19:34:30.558096 after 1.76 seconds
[0m19:34:30.558096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBD623280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBFD39BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBFD39850>]}
[0m19:34:30.559095 [debug] [MainThread]: Flushing usage events
[0m19:34:31.513478 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:37:29.207592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EDD8232B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EDF8A5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EDF8A5580>]}


============================== 19:37:29.207592 | 828c4016-4688-4542-ad28-fd1813334545 ==============================
[0m19:37:29.207592 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:37:29.207592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\amiru\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\amiru\\Documents\\mochi_dbt\\mochi_analysis\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:37:29.370172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '828c4016-4688-4542-ad28-fd1813334545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EDBDA0190>]}
[0m19:37:29.412271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '828c4016-4688-4542-ad28-fd1813334545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EDBED2910>]}
[0m19:37:29.413272 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:37:29.673974 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:37:29.841652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:37:29.842653 [debug] [MainThread]: Partial parsing: updated file: mochi_analysis://models\Staging\stg_panel_evaluations.sql
[0m19:37:30.036719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '828c4016-4688-4542-ad28-fd1813334545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EE003FEB0>]}
[0m19:37:30.114847 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\manifest.json
[0m19:37:30.114847 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\semantic_manifest.json
[0m19:37:30.146101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '828c4016-4688-4542-ad28-fd1813334545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EDFF14070>]}
[0m19:37:30.146101 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 433 macros
[0m19:37:30.146101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '828c4016-4688-4542-ad28-fd1813334545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EDFF14850>]}
[0m19:37:30.161726 [info ] [MainThread]: 
[0m19:37:30.161726 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:37:30.161726 [info ] [MainThread]: 
[0m19:37:30.161726 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:37:30.161726 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mochi_data'
[0m19:37:30.240866 [debug] [ThreadPool]: Using postgres connection "list_mochi_data"
[0m19:37:30.240866 [debug] [ThreadPool]: On list_mochi_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "list_mochi_data"} */

    select distinct nspname from pg_namespace
  
[0m19:37:30.240866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:30.271072 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.029 seconds
[0m19:37:30.271072 [debug] [ThreadPool]: On list_mochi_data: Close
[0m19:37:30.273072 [debug] [ThreadPool]: Acquiring new postgres connection 'list_mochi_data_dbt_mochi'
[0m19:37:30.277073 [debug] [ThreadPool]: Using postgres connection "list_mochi_data_dbt_mochi"
[0m19:37:30.278073 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: BEGIN
[0m19:37:30.278073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:30.412734 [debug] [ThreadPool]: SQL status: BEGIN in 0.139 seconds
[0m19:37:30.412734 [debug] [ThreadPool]: Using postgres connection "list_mochi_data_dbt_mochi"
[0m19:37:30.412734 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "list_mochi_data_dbt_mochi"} */
select
      'mochi_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_mochi'
    union all
    select
      'mochi_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_mochi'
    union all
    select
      'mochi_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_mochi'
  
[0m19:37:30.412734 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m19:37:30.412734 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: ROLLBACK
[0m19:37:30.412734 [debug] [ThreadPool]: On list_mochi_data_dbt_mochi: Close
[0m19:37:30.412734 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:30.412734 [debug] [MainThread]: On master: BEGIN
[0m19:37:30.412734 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:37:30.443985 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m19:37:30.443985 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:30.443985 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:37:30.443985 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m19:37:30.443985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '828c4016-4688-4542-ad28-fd1813334545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EDFE84AC0>]}
[0m19:37:30.443985 [debug] [MainThread]: On master: ROLLBACK
[0m19:37:30.459612 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:30.459612 [debug] [MainThread]: On master: BEGIN
[0m19:37:30.459612 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:37:30.459612 [debug] [MainThread]: On master: COMMIT
[0m19:37:30.459612 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:30.459612 [debug] [MainThread]: On master: COMMIT
[0m19:37:30.459612 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:37:30.459612 [debug] [MainThread]: On master: Close
[0m19:37:30.459612 [debug] [Thread-1  ]: Began running node model.mochi_analysis.my_first_dbt_model
[0m19:37:30.459612 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_mochi.my_first_dbt_model ...................... [RUN]
[0m19:37:30.459612 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.mochi_analysis.my_first_dbt_model'
[0m19:37:30.459612 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.my_first_dbt_model
[0m19:37:30.459612 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.my_first_dbt_model"
[0m19:37:30.459612 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.my_first_dbt_model
[0m19:37:30.499198 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.my_first_dbt_model"
[0m19:37:30.500196 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:37:30.500196 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: BEGIN
[0m19:37:30.501197 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:37:30.525005 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m19:37:30.526005 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:37:30.526005 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */

  
    

  create  table "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:37:30.529553 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.003 seconds
[0m19:37:30.533568 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:37:30.533568 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:37:30.533568 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:37:30.533568 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:37:30.533568 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:37:30.533568 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:37:30.549193 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: COMMIT
[0m19:37:30.549193 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:37:30.549193 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: COMMIT
[0m19:37:30.549193 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m19:37:30.549193 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_backup"
[0m19:37:30.549193 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_first_dbt_model"
[0m19:37:30.549193 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_first_dbt_model"} */
drop table if exists "mochi_data"."dbt_mochi"."my_first_dbt_model__dbt_backup" cascade
[0m19:37:30.549193 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m19:37:30.564819 [debug] [Thread-1  ]: On model.mochi_analysis.my_first_dbt_model: Close
[0m19:37:30.564819 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828c4016-4688-4542-ad28-fd1813334545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EE133BA30>]}
[0m19:37:30.564819 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_mochi.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.11s]
[0m19:37:30.564819 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.my_first_dbt_model
[0m19:37:30.564819 [debug] [Thread-1  ]: Began running node model.mochi_analysis.stg_panel_evaluations
[0m19:37:30.564819 [info ] [Thread-1  ]: 2 of 4 START sql view model dbt_mochi.stg_panel_evaluations .................... [RUN]
[0m19:37:30.564819 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.my_first_dbt_model, now model.mochi_analysis.stg_panel_evaluations)
[0m19:37:30.564819 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.stg_panel_evaluations
[0m19:37:30.564819 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.stg_panel_evaluations"
[0m19:37:30.564819 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.stg_panel_evaluations
[0m19:37:30.586082 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.stg_panel_evaluations"
[0m19:37:30.587095 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:37:30.587095 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: BEGIN
[0m19:37:30.587095 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:37:30.605828 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m19:37:30.605828 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:37:30.605828 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */

  create view "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_tmp"
    
    
  as (
    -- models/Staging/stg_panel_evaluations.sql

select
    "Timestamp" as raw_timestamp,
    -- Formulation 1
    CAST("Bitterness" AS INTEGER) as bitterness_1, -- Assuming Bitterness is just a number
    "Sweetness" as sweetness_1, -- NO CAST here, it has (X)
    "Chamomile Flavour" as chamomile_flavour_1, -- NO CAST here
    "Honey Flavour" as honey_flavour_1, -- NO CAST here
    "Creaminess" as creaminess_1, -- NO CAST here
    CAST("Overall Acceptability" AS INTEGER) as overall_acceptability_1, -- Assuming Overall Acceptability is just a number

    -- Formulation 2
    CAST("Bitterness.1" AS INTEGER) as bitterness_2,
    "Sweetness.1" as sweetness_2,
    "Chamomile Flavour.1" as chamomile_flavour_2,
    "Honey Flavour.1" as honey_flavour_2,
    "Creaminess.1" as creaminess_2,
    CAST("Overall Acceptability.1" AS INTEGER) as overall_acceptability_2,

    -- Formulation 3
    CAST("Bitterness.2" AS INTEGER) as bitterness_3,
    "Sweetness.2" as sweetness_3,
    "Chamomile Flavour.2" as chamomile_flavour_3,
    "Honey Flavour.2" as honey_flavour_3,
    "Creaminess.2" as creaminess_3,
    CAST("Overall Acceptability.2" AS INTEGER) as overall_acceptability_3,

    -- Formulation 4
    CAST("Bitterness.3" AS INTEGER) as bitterness_4,
    "Sweetness.3" as sweetness_4,
    "Chamomile Flavour.3" as chamomile_flavour_4,
    "Honey Flavour.3" as honey_flavour_4,
    "Creaminess.3" as creaminess_4,
    CAST("Overall Acceptability.3" AS INTEGER) as overall_acceptability_4,

    -- Formulation 5
    CAST("Bitterness.4" AS INTEGER) as bitterness_5,
    "Sweetness.4" as sweetness_5,
    "Chamomile Flavour.4" as chamomile_flavour_5,
    "Honey Flavour.4" as honey_flavour_5,
    "Creaminess.4" as creaminess_5,
    CAST("Overall Acceptability.4" AS INTEGER) as overall_acceptability_5

from "mochi_data"."public"."raw_panel_evaluations"
  );
[0m19:37:30.616478 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m19:37:30.616478 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:37:30.616478 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
alter table "mochi_data"."dbt_mochi"."stg_panel_evaluations" rename to "stg_panel_evaluations__dbt_backup"
[0m19:37:30.616478 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:37:30.616478 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:37:30.616478 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
alter table "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_tmp" rename to "stg_panel_evaluations"
[0m19:37:30.616478 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:37:30.616478 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: COMMIT
[0m19:37:30.616478 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:37:30.616478 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: COMMIT
[0m19:37:30.616478 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m19:37:30.616478 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_backup"
[0m19:37:30.616478 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.stg_panel_evaluations"
[0m19:37:30.616478 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.stg_panel_evaluations"} */
drop view if exists "mochi_data"."dbt_mochi"."stg_panel_evaluations__dbt_backup" cascade
[0m19:37:30.632520 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m19:37:30.633518 [debug] [Thread-1  ]: On model.mochi_analysis.stg_panel_evaluations: Close
[0m19:37:30.633518 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828c4016-4688-4542-ad28-fd1813334545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EDEB5DAC0>]}
[0m19:37:30.634518 [info ] [Thread-1  ]: 2 of 4 OK created sql view model dbt_mochi.stg_panel_evaluations ............... [[32mCREATE VIEW[0m in 0.07s]
[0m19:37:30.635518 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.stg_panel_evaluations
[0m19:37:30.635518 [debug] [Thread-1  ]: Began running node model.mochi_analysis.my_second_dbt_model
[0m19:37:30.635518 [info ] [Thread-1  ]: 3 of 4 START sql view model dbt_mochi.my_second_dbt_model ...................... [RUN]
[0m19:37:30.636519 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.stg_panel_evaluations, now model.mochi_analysis.my_second_dbt_model)
[0m19:37:30.636519 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.my_second_dbt_model
[0m19:37:30.638519 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.my_second_dbt_model"
[0m19:37:30.639520 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.my_second_dbt_model
[0m19:37:30.642520 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.my_second_dbt_model"
[0m19:37:30.643520 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:37:30.643520 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: BEGIN
[0m19:37:30.643520 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:37:30.670356 [debug] [Thread-1  ]: SQL status: BEGIN in 0.026 seconds
[0m19:37:30.670356 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:37:30.670356 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */

  create view "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "mochi_data"."dbt_mochi"."my_first_dbt_model"
where id = 1
  );
[0m19:37:30.671367 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:37:30.671367 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:37:30.671367 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */
alter table "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:37:30.671367 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:37:30.671367 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: COMMIT
[0m19:37:30.671367 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:37:30.671367 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: COMMIT
[0m19:37:30.671367 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m19:37:30.671367 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_backup"
[0m19:37:30.682519 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.my_second_dbt_model"
[0m19:37:30.682519 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.my_second_dbt_model"} */
drop view if exists "mochi_data"."dbt_mochi"."my_second_dbt_model__dbt_backup" cascade
[0m19:37:30.683602 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m19:37:30.683602 [debug] [Thread-1  ]: On model.mochi_analysis.my_second_dbt_model: Close
[0m19:37:30.683602 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828c4016-4688-4542-ad28-fd1813334545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EE1425E80>]}
[0m19:37:30.683602 [info ] [Thread-1  ]: 3 of 4 OK created sql view model dbt_mochi.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.05s]
[0m19:37:30.683602 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.my_second_dbt_model
[0m19:37:30.683602 [debug] [Thread-1  ]: Began running node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m19:37:30.683602 [info ] [Thread-1  ]: 4 of 4 START sql view model dbt_mochi.fct_panel_evaluations_unpivoted .......... [RUN]
[0m19:37:30.683602 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mochi_analysis.my_second_dbt_model, now model.mochi_analysis.fct_panel_evaluations_unpivoted)
[0m19:37:30.683602 [debug] [Thread-1  ]: Began compiling node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m19:37:30.683602 [debug] [Thread-1  ]: Writing injected SQL for node "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m19:37:30.683602 [debug] [Thread-1  ]: Began executing node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m19:37:30.683602 [debug] [Thread-1  ]: Writing runtime sql for node "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m19:37:30.683602 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m19:37:30.683602 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: BEGIN
[0m19:37:30.683602 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:37:30.830412 [debug] [Thread-1  ]: SQL status: BEGIN in 0.138 seconds
[0m19:37:30.830412 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m19:37:30.830412 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.fct_panel_evaluations_unpivoted"} */

  create view "mochi_data"."dbt_mochi"."fct_panel_evaluations_unpivoted__dbt_tmp"
    
    
  as (
    -- models/fct_panel_evaluations_unpivoted.sql

SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '1' AS Formulation,
    bitterness_1 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_1, STRPOS(sweetness_1, '(') + 1, STRPOS(sweetness_1, ')') - STRPOS(sweetness_1, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_1, STRPOS(chamomile_flavour_1, '(') + 1, STRPOS(chamomile_flavour_1, ')') - STRPOS(chamomile_flavour_1, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_1, STRPOS(honey_flavour_1, '(') + 1, STRPOS(honey_flavour_1, ')') - STRPOS(honey_flavour_1, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_1, STRPOS(creaminess_1, '(') + 1, STRPOS(creaminess_1, ')') - STRPOS(creaminess_1, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_1 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '2' AS Formulation,
    bitterness_2 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_2, STRPOS(sweetness_2, '(') + 1, STRPOS(sweetness_2, ')') - STRPOS(sweetness_2, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_2, STRPOS(chamomile_flavour_2, '(') + 1, STRPOS(chamomile_flavour_2, ')') - STRPOS(chamomile_flavour_2, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_2, STRPOS(honey_flavour_2, '(') + 1, STRPOS(honey_flavour_2, ')') - STRPOS(honey_flavour_2, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_2, STRPOS(creaminess_2, '(') + 1, STRPOS(creaminess_2, ')') - STRPOS(creaminess_2, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_2 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

-- Repeat for Flavor 3
SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '3' AS Formulation,
    bitterness_3 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_3, STRPOS(sweetness_3, '(') + 1, STRPOS(sweetness_3, ')') - STRPOS(sweetness_3, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_3, STRPOS(chamomile_flavour_3, '(') + 1, STRPOS(chamomile_flavour_3, ')') - STRPOS(chamomile_flavour_3, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_3, STRPOS(honey_flavour_3, '(') + 1, STRPOS(honey_flavour_3, ')') - STRPOS(honey_flavour_3, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_3, STRPOS(creaminess_3, '(') + 1, STRPOS(creaminess_3, ')') - STRPOS(creaminess_3, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_3 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

-- Repeat for Flavor 4
SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '4' AS Formulation,
    bitterness_4 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_4, STRPOS(sweetness_4, '(') + 1, STRPOS(sweetness_4, ')') - STRPOS(sweetness_4, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_4, STRPOS(chamomile_flavour_4, '(') + 1, STRPOS(chamomile_flavour_4, ')') - STRPOS(chamomile_flavour_4, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_4, STRPOS(honey_flavour_4, '(') + 1, STRPOS(honey_flavour_4, ')') - STRPOS(honey_flavour_4, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_4, STRPOS(creaminess_4, '(') + 1, STRPOS(creaminess_4, ')') - STRPOS(creaminess_4, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_4 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1

UNION ALL

-- Repeat for Flavor 5
SELECT
    TO_CHAR(raw_timestamp, 'YYYYMMDDHH24MISS') AS submission_id,
    '5' AS Formulation,
    bitterness_5 AS bitterness_score,
    CAST(NULLIF(SUBSTRING(sweetness_5, STRPOS(sweetness_5, '(') + 1, STRPOS(sweetness_5, ')') - STRPOS(sweetness_5, '(') - 1), '') AS INTEGER) AS sweetness_score,
    CAST(NULLIF(SUBSTRING(chamomile_flavour_5, STRPOS(chamomile_flavour_5, '(') + 1, STRPOS(chamomile_flavour_5, ')') - STRPOS(chamomile_flavour_5, '(') - 1), '') AS INTEGER) AS chamomile_flavour_score,
    CAST(NULLIF(SUBSTRING(honey_flavour_5, STRPOS(honey_flavour_5, '(') + 1, STRPOS(honey_flavour_5, ')') - STRPOS(honey_flavour_5, '(') - 1), '') AS INTEGER) AS honey_flavour_score,
    CAST(NULLIF(SUBSTRING(creaminess_5, STRPOS(creaminess_5, '(') + 1, STRPOS(creaminess_5, ')') - STRPOS(creaminess_5, '(') - 1), '') AS INTEGER) AS creaminess_score,
    overall_acceptability_5 AS overall_acceptability_score
FROM
    "mochi_data"."dbt_mochi"."stg_panel_evaluations" -- <--- IMPORTANT CHANGE HERE
WHERE
    1=1
  );
[0m19:37:30.830412 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m19:37:30.830412 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m19:37:30.830412 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.fct_panel_evaluations_unpivoted"} */
alter table "mochi_data"."dbt_mochi"."fct_panel_evaluations_unpivoted__dbt_tmp" rename to "fct_panel_evaluations_unpivoted"
[0m19:37:30.830412 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:37:30.846038 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: COMMIT
[0m19:37:30.846038 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m19:37:30.846038 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: COMMIT
[0m19:37:30.846038 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m19:37:30.846038 [debug] [Thread-1  ]: Applying DROP to: "mochi_data"."dbt_mochi"."fct_panel_evaluations_unpivoted__dbt_backup"
[0m19:37:30.846038 [debug] [Thread-1  ]: Using postgres connection "model.mochi_analysis.fct_panel_evaluations_unpivoted"
[0m19:37:30.846038 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "mochi_analysis", "target_name": "dev", "node_id": "model.mochi_analysis.fct_panel_evaluations_unpivoted"} */
drop view if exists "mochi_data"."dbt_mochi"."fct_panel_evaluations_unpivoted__dbt_backup" cascade
[0m19:37:30.846038 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m19:37:30.846038 [debug] [Thread-1  ]: On model.mochi_analysis.fct_panel_evaluations_unpivoted: Close
[0m19:37:30.846038 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '828c4016-4688-4542-ad28-fd1813334545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EE1548F70>]}
[0m19:37:30.846038 [info ] [Thread-1  ]: 4 of 4 OK created sql view model dbt_mochi.fct_panel_evaluations_unpivoted ..... [[32mCREATE VIEW[0m in 0.16s]
[0m19:37:30.846038 [debug] [Thread-1  ]: Finished running node model.mochi_analysis.fct_panel_evaluations_unpivoted
[0m19:37:30.846038 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:30.846038 [debug] [MainThread]: On master: BEGIN
[0m19:37:30.846038 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:37:30.994888 [debug] [MainThread]: SQL status: BEGIN in 0.144 seconds
[0m19:37:30.994888 [debug] [MainThread]: On master: COMMIT
[0m19:37:30.994888 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:30.994888 [debug] [MainThread]: On master: COMMIT
[0m19:37:30.994888 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:37:30.994888 [debug] [MainThread]: On master: Close
[0m19:37:30.994888 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:37:30.994888 [debug] [MainThread]: Connection 'list_mochi_data' was properly closed.
[0m19:37:30.994888 [debug] [MainThread]: Connection 'list_mochi_data_dbt_mochi' was properly closed.
[0m19:37:30.994888 [debug] [MainThread]: Connection 'model.mochi_analysis.fct_panel_evaluations_unpivoted' was properly closed.
[0m19:37:30.994888 [info ] [MainThread]: 
[0m19:37:30.994888 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m19:37:30.994888 [debug] [MainThread]: Command end result
[0m19:37:31.019711 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\manifest.json
[0m19:37:31.021712 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\semantic_manifest.json
[0m19:37:31.022722 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\amiru\Documents\mochi_dbt\mochi_analysis\target\run_results.json
[0m19:37:31.022722 [info ] [MainThread]: 
[0m19:37:31.022722 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:37:31.022722 [info ] [MainThread]: 
[0m19:37:31.022722 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:37:31.022722 [debug] [MainThread]: Command `dbt run` succeeded at 19:37:31.022722 after 1.86 seconds
[0m19:37:31.022722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EDD8232B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EDBED2910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EDFF14070>]}
[0m19:37:31.022722 [debug] [MainThread]: Flushing usage events
[0m19:37:31.949479 [debug] [MainThread]: An error was encountered while trying to flush usage events
